import{V as w,_ as F}from"./VirtualTree-CLMOwxGI.js";import{d as I,r as p,c as v,a,f as N,b as O,g as T,u as y,F as P,h as j,t as q,o as f}from"./index-C5EC9bir.js";const z={class:"demo-section"},A={class:"tree-container"},G={class:"tree-shell"},H={key:0,class:"drag-log"},J=I({__name:"DraggableDemo",setup(K){const D=()=>[{id:"drag-1",label:"拖拽节点 1",children:[{id:"drag-1-1",label:"拖拽节点 1-1"},{id:"drag-1-2",label:"拖拽节点 1-2"}]},{id:"drag-2",label:"拖拽节点 2",children:[{id:"drag-2-1",label:"拖拽节点 2-1",children:[{id:"drag-2-1-1",label:"拖拽节点 2-1-1"},{id:"drag-2-1-2",label:"拖拽节点 2-1-2"}]},{id:"drag-2-2",label:"拖拽节点 2-2"}]},{id:"drag-3",label:"拖拽节点 3"}],u=p(D()),s=p([]),c=e=>{const l=new Date().toLocaleTimeString();s.value.unshift(`[${l}] ${e}`),s.value.length>20&&(s.value=s.value.slice(0,20))},x=()=>{s.value=[]},$=()=>{u.value=D(),s.value=[]},k=(e,l)=>{c(`开始拖拽节点: ${e.label||e.id}`),console.log("Drag start:",e)},L=(e,l,n)=>{c(`进入节点: ${n.label||n.id}`),console.log("Drag enter:",{draggingNode:e,node:n})},V=(e,l,n)=>{c(`离开节点: ${n.label||n.id}`),console.log("Drag leave:",{draggingNode:e,node:n})},E=(e,l,n)=>{console.log("Drag over:",{draggingNode:e,node:n})},B=(e,l)=>{c(`结束拖拽: ${e.label||e.id}`),console.log("Drag end:",e)},b=(e,l,n=null)=>{var o;for(let d=0;d<e.length;d++){const t=e[d];if(t.id===l)return{node:t,parent:n,siblings:e,index:d};if((o=t.children)!=null&&o.length){const r=b(t.children,l,t);if(r)return r}}return null},C=(e,l)=>{const n=b(e,l);return n?(n.siblings.splice(n.index,1),n):null},m=(e,l)=>{const n=e.children||[];for(const o of n)if(o.id===l||m(o,l))return!0;return!1},M=(e,l,n,o)=>{const d={prev:"之前",inner:"内部",next:"之后"};if(c(`放置节点: ${e.label||e.id} -> ${l.label||l.id} (${d[n]})`),console.log("Node dropped:",{draggingNode:e,dropNode:l,dropType:n}),e.id===l.id)return;if(m(e,l.id)){c("无法将节点放置到其自身的子节点位置");return}const t=[...u.value],r=C(t,e.id);if(!r)return;const i=b(t,l.id);if(!i){u.value=[...D()];return}const _=(g,h)=>{const S=g?g.children=g.children||[]:t;r.parent&&g&&r.parent.id===g.id&&r.index<h&&(h-=1),S.splice(h,0,r.node)};n==="inner"?(i.node.children=i.node.children||[],i.node.children.push(r.node)):n==="prev"?_(i.parent,i.index):n==="next"&&_(i.parent,i.index+1),u.value=[...t]};return(e,l)=>(f(),v("div",z,[l[1]||(l[1]=a("h2",null,"可拖拽",-1)),l[2]||(l[2]=a("div",{class:"info-box"},[a("p",null,[a("strong",null,"说明："),O("拖拽节点可以重新排序，支持拖拽到节点前、节点内、节点后三种位置")])],-1)),a("div",A,[a("div",G,[T(y(w),{data:u.value,class:"tree-scroll",draggable:"",onNodeDragStart:k,onNodeDragEnter:L,onNodeDragLeave:V,onNodeDragOver:E,onNodeDragEnd:B,onNodeDrop:M},null,8,["data"])])]),a("div",{class:"control-panel"},[a("button",{onClick:$,class:"btn"},"重置拖拽数据")]),s.value.length>0?(f(),v("div",H,[l[0]||(l[0]=a("h3",null,"拖拽日志：",-1)),(f(!0),v(P,null,j(s.value,(n,o)=>(f(),v("div",{class:"log-item",key:o},q(n),1))),128)),a("button",{onClick:x,class:"btn btn-small"},"清空日志")])):N("",!0)]))}}),U=F(J,[["__scopeId","data-v-fdecf76d"]]);export{U as default};

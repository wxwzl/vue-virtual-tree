import{V as w,_ as F}from"./VirtualTree-DWp-WEMZ.js";import{d as I,r as p,c as v,a as r,f as N,g as O,h as T,u as y,F as P,i as j,t as q,e as D}from"./index-DxXrj-0e.js";const z={class:"demo-section"},A={class:"tree-container"},G={key:0,class:"drag-log"},H=I({__name:"DraggableDemo",setup(J){const f=()=>[{id:"drag-1",label:"拖拽节点 1",children:[{id:"drag-1-1",label:"拖拽节点 1-1"},{id:"drag-1-2",label:"拖拽节点 1-2"}]},{id:"drag-2",label:"拖拽节点 2",children:[{id:"drag-2-1",label:"拖拽节点 2-1",children:[{id:"drag-2-1-1",label:"拖拽节点 2-1-1"},{id:"drag-2-1-2",label:"拖拽节点 2-1-2"}]},{id:"drag-2-2",label:"拖拽节点 2-2"}]},{id:"drag-3",label:"拖拽节点 3"}],u=p(f()),s=p([]),c=e=>{const n=new Date().toLocaleTimeString();s.value.unshift(`[${n}] ${e}`),s.value.length>20&&(s.value=s.value.slice(0,20))},x=()=>{s.value=[]},$=()=>{u.value=f(),s.value=[]},k=(e,n)=>{c(`开始拖拽节点: ${e.label||e.id}`),console.log("Drag start:",e)},L=(e,n,l)=>{c(`进入节点: ${l.label||l.id}`),console.log("Drag enter:",{draggingNode:e,node:l})},V=(e,n,l)=>{c(`离开节点: ${l.label||l.id}`),console.log("Drag leave:",{draggingNode:e,node:l})},E=(e,n,l)=>{console.log("Drag over:",{draggingNode:e,node:l})},B=(e,n)=>{c(`结束拖拽: ${e.label||e.id}`),console.log("Drag end:",e)},b=(e,n,l=null)=>{var o;for(let d=0;d<e.length;d++){const a=e[d];if(a.id===n)return{node:a,parent:l,siblings:e,index:d};if((o=a.children)!=null&&o.length){const t=b(a.children,n,a);if(t)return t}}return null},C=(e,n)=>{const l=b(e,n);return l?(l.siblings.splice(l.index,1),l):null},m=(e,n)=>{const l=e.children||[];for(const o of l)if(o.id===n||m(o,n))return!0;return!1},M=(e,n,l,o)=>{const d={prev:"之前",inner:"内部",next:"之后"};if(c(`放置节点: ${e.label||e.id} -> ${n.label||n.id} (${d[l]})`),console.log("Node dropped:",{draggingNode:e,dropNode:n,dropType:l}),e.id===n.id)return;if(m(e,n.id)){c("无法将节点放置到其自身的子节点位置");return}const a=[...u.value],t=C(a,e.id);if(!t)return;const i=b(a,n.id);if(!i){u.value=[...f()];return}const _=(g,h)=>{const S=g?g.children=g.children||[]:a;t.parent&&g&&t.parent.id===g.id&&t.index<h&&(h-=1),S.splice(h,0,t.node)};l==="inner"?(i.node.children=i.node.children||[],i.node.children.push(t.node)):l==="prev"?_(i.parent,i.index):l==="next"&&_(i.parent,i.index+1),u.value=[...a]};return(e,n)=>(D(),v("div",z,[n[1]||(n[1]=r("h2",null,"可拖拽",-1)),n[2]||(n[2]=r("div",{class:"info-box"},[r("p",null,[r("strong",null,"说明："),O("拖拽节点可以重新排序，支持拖拽到节点前、节点内、节点后三种位置")])],-1)),r("div",A,[T(y(w),{data:u.value,height:400,draggable:"",onNodeDragStart:k,onNodeDragEnter:L,onNodeDragLeave:V,onNodeDragOver:E,onNodeDragEnd:B,onNodeDrop:M},null,8,["data"])]),r("div",{class:"control-panel"},[r("button",{onClick:$,class:"btn"},"重置拖拽数据")]),s.value.length>0?(D(),v("div",G,[n[0]||(n[0]=r("h3",null,"拖拽日志：",-1)),(D(!0),v(P,null,j(s.value,(l,o)=>(D(),v("div",{class:"log-item",key:o},q(l),1))),128)),r("button",{onClick:x,class:"btn btn-small"},"清空日志")])):N("",!0)]))}}),R=F(H,[["__scopeId","data-v-23a53ae2"]]);export{R as default};

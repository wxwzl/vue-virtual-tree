let a,I=0,w=null;function A(){return(w===null||w.byteLength===0)&&(w=new Uint8Array(a.memory.buffer)),w}const b=new TextEncoder;"encodeInto"in b||(b.encodeInto=function(e,t){const n=b.encode(e);return t.set(n),{read:e.length,written:n.length}});function V(e,t,n){if(n===void 0){const o=b.encode(e),u=t(o.length,1)>>>0;return A().subarray(u,u+o.length).set(o),I=o.length,u}let r=e.length,i=t(r,1)>>>0;const c=A();let s=0;for(;s<r;s++){const o=e.charCodeAt(s);if(o>127)break;c[i+s]=o}if(s!==r){s!==0&&(e=e.slice(s)),i=n(i,r,r=s+e.length*3,1)>>>0;const o=A().subarray(i+s,i+r),u=b.encodeInto(e,o);s+=u.written,i=n(i,r,s,1)>>>0}return I=s,i}let d=null;function p(){return(d===null||d.buffer.detached===!0||d.buffer.detached===void 0&&d.buffer!==a.memory.buffer)&&(d=new DataView(a.memory.buffer)),d}let E=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});E.decode();const P=2146435072;let W=0;function J(e,t){return W+=t,W>=P&&(E=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}),E.decode(),W=t),E.decode(A().subarray(e,e+t))}function x(e,t){return e=e>>>0,J(e,t)}function U(e,t){if(!(e instanceof t))throw new Error(`expected instance of ${t.name}`)}function j(e){return U(e,T),a.generateVirtualTreeData(e.__wbg_ptr)}const k=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>a.__wbg_generateoptions_free(e>>>0,1));class T{__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,k.unregister(this),t}free(){const t=this.__destroy_into_raw();a.__wbg_generateoptions_free(t,0)}constructor(t,n,r){const i=a.generateoptions_new(t,n,r);return this.__wbg_ptr=i>>>0,k.register(this,this.__wbg_ptr,this),this}}Symbol.dispose&&(T.prototype[Symbol.dispose]=T.prototype.free);const B=new Set(["basic","cors","default"]);async function L(e,t){if(typeof Response=="function"&&e instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(e,t)}catch(r){if(e.ok&&B.has(e.type)&&e.headers.get("Content-Type")!=="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}else{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}function N(){const e={};return e.wbg={},e.wbg.__wbg_String_8f0eb39a4a4c2f66=function(t,n){const r=String(n),i=V(r,a.__wbindgen_malloc,a.__wbindgen_realloc),c=I;p().setInt32(t+4*1,c,!0),p().setInt32(t+4*0,i,!0)},e.wbg.__wbg___wbindgen_throw_b855445ff6a94295=function(t,n){throw new Error(x(t,n))},e.wbg.__wbg_error_7534b8e9a36f1ab4=function(t,n){let r,i;try{r=t,i=n,console.error(x(t,n))}finally{a.__wbindgen_free(r,i,1)}},e.wbg.__wbg_new_1acc0b6eea89d040=function(){return new Object},e.wbg.__wbg_new_8a6f238a6ece86ea=function(){return new Error},e.wbg.__wbg_new_e17d9f43105b08be=function(){return new Array},e.wbg.__wbg_set_3f1d0b984ed272ed=function(t,n,r){t[n]=r},e.wbg.__wbg_set_c213c871859d6500=function(t,n,r){t[n>>>0]=r},e.wbg.__wbg_stack_0ed75d68575b0f3c=function(t,n){const r=n.stack,i=V(r,a.__wbindgen_malloc,a.__wbindgen_realloc),c=I;p().setInt32(t+4*1,c,!0),p().setInt32(t+4*0,i,!0)},e.wbg.__wbindgen_cast_2241b6af4c4b2941=function(t,n){return x(t,n)},e.wbg.__wbindgen_cast_d6cd19b81560fd6e=function(t){return t},e.wbg.__wbindgen_init_externref_table=function(){const t=a.__wbindgen_externrefs,n=t.grow(4);t.set(0,void 0),t.set(n+0,void 0),t.set(n+1,null),t.set(n+2,!0),t.set(n+3,!1)},e}function q(e,t){return a=e.exports,F.__wbindgen_wasm_module=t,d=null,w=null,a.__wbindgen_start(),a}async function F(e){if(a!==void 0)return a;typeof e<"u"&&(Object.getPrototypeOf(e)===Object.prototype?{module_or_path:e}=e:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof e>"u"&&(e=new URL("/vue-virtual-tree/assets/data_generator_bg-Cs4nHoe-.wasm",import.meta.url));const t=N();(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:r}=await L(await e,t);return q(n,r)}let M=!1,S=null;async function G(){if(!M)return S||(S=(async()=>{try{await F(),M=!0}catch(e){throw console.warn("WASM 模块初始化失败，将使用 JS 回退方案:",e),e}})(),S)}async function X(e=5e3,t={}){const n=t.childCount??5,r=t.grandChildCount??5;try{Y()||await G();const i=new T(e,n,r),c=j(i);return i.free(),c}catch(i){throw console.error("WASM 生成失败:",i),i}}function Y(){return M}const C=(e,t)=>Number.isNaN(e)||e<=0?t:Math.floor(e),z=(e=5e3,t={})=>{const n=C(e,1),r=C(t.chunkSize??50,50),i=C(t.childCount??5,5),c=C(t.grandChildCount??5,5),s=t.decorator;return new Promise(o=>{const u=[];let g=1,y=0;const D=()=>{const R=Math.min(g+r,n+1);for(let f=g;f<R;f++){const h={id:`node-${f}`,label:`节点 ${f}`};s==null||s(h,{level:0,parentId:null,index:f}),y++;const O=[];for(let l=1;l<=i;l++){const m={id:`node-${f}-${l}`,label:`节点 ${f}-${l}`};s==null||s(m,{level:1,parentId:h.id,index:l}),y++;const $=[];for(let _=1;_<=c;_++){const v={id:`node-${f}-${l}-${_}`,label:`节点 ${f}-${l}-${_}`};s==null||s(v,{level:2,parentId:m.id,index:_}),y++,$.push(v)}m.children=$,O.push(m)}h.children=O,u.push(h)}g=R,g<=n?requestAnimationFrame(D):o({data:u,totalCount:y})};D()})},H=async(e=5e3,t={})=>{if(t.decorator||t.forceJS)return z(e,t);try{const r={childCount:t.childCount,grandChildCount:t.grandChildCount};console.time("WASM 生成树数据");const i=await X(e,r);return console.timeEnd("WASM 生成树数据"),i}catch(r){console.warn("WASM 版本不可用，回退到 JS 版本:",r)}console.time("JS 生成树数据");const n=await z(e,t);return console.timeEnd("JS 生成树数据"),n},K=(e=5e3,t={})=>{const n=t.delay??1e3;return new Promise(r=>{setTimeout(async()=>{const i=await H(e,t);r(i)},n)})};export{H as a,K as g};

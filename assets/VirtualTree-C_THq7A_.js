import{n as he,p as dt,q as ct,s as ut,x as fe,o as H,y as ht,z as ft,A as We,B as vt,w as pt,c as ee,b as ge,f as je,C as q,h as te,F as qe,j as gt,D as Be,E as Ye,G as mt,H as Me,I as we,J as yt,K as bt,L as St,d as Ge,r as j,M as le,a as G,e as zt,t as kt,g as Se,N as wt,u as ue}from"./index-a_h8Fo-g.js";function $t(){var e=window.navigator.userAgent,i=e.indexOf("MSIE ");if(i>0)return parseInt(e.substring(i+5,e.indexOf(".",i)),10);var t=e.indexOf("Trident/");if(t>0){var s=e.indexOf("rv:");return parseInt(e.substring(s+3,e.indexOf(".",s)),10)}var n=e.indexOf("Edge/");return n>0?parseInt(e.substring(n+5,e.indexOf(".",n)),10):-1}let ze;function Oe(){Oe.init||(Oe.init=!0,ze=$t()!==-1)}var xe={name:"ResizeObserver",props:{emitOnMount:{type:Boolean,default:!1},ignoreWidth:{type:Boolean,default:!1},ignoreHeight:{type:Boolean,default:!1}},emits:["notify"],mounted(){Oe(),he(()=>{this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitOnMount&&this.emitSize()});const e=document.createElement("object");this._resizeObject=e,e.setAttribute("aria-hidden","true"),e.setAttribute("tabindex",-1),e.onload=this.addResizeHandlers,e.type="text/html",ze&&this.$el.appendChild(e),e.data="about:blank",ze||this.$el.appendChild(e)},beforeUnmount(){this.removeResizeHandlers()},methods:{compareAndNotify(){(!this.ignoreWidth&&this._w!==this.$el.offsetWidth||!this.ignoreHeight&&this._h!==this.$el.offsetHeight)&&(this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitSize())},emitSize(){this.$emit("notify",{width:this._w,height:this._h})},addResizeHandlers(){this._resizeObject.contentDocument.defaultView.addEventListener("resize",this.compareAndNotify),this.compareAndNotify()},removeResizeHandlers(){this._resizeObject&&this._resizeObject.onload&&(!ze&&this._resizeObject.contentDocument&&this._resizeObject.contentDocument.defaultView.removeEventListener("resize",this.compareAndNotify),this.$el.removeChild(this._resizeObject),this._resizeObject.onload=null,this._resizeObject=null)}}};const Dt=ut();dt("data-v-b329ee4c");const xt={class:"resize-observer",tabindex:"-1"};ct();const It=Dt((e,i,t,s,n,d)=>(H(),fe("div",xt)));xe.render=It;xe.__scopeId="data-v-b329ee4c";xe.__file="src/components/ResizeObserver.vue";function ke(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ke=function(i){return typeof i}:ke=function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},ke(e)}function _t(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function Ct(e,i){for(var t=0;t<i.length;t++){var s=i[t];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function Tt(e,i,t){return i&&Ct(e.prototype,i),e}function Fe(e){return Nt(e)||Et(e)||Ot(e)||At()}function Nt(e){if(Array.isArray(e))return Ae(e)}function Et(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function Ot(e,i){if(e){if(typeof e=="string")return Ae(e,i);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Ae(e,i)}}function Ae(e,i){(i==null||i>e.length)&&(i=e.length);for(var t=0,s=new Array(i);t<i;t++)s[t]=e[t];return s}function At(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vt(e){var i;return typeof e=="function"?i={callback:e}:i=e,i}function Rt(e,i){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s,n,d,c=function(h){for(var z=arguments.length,_=new Array(z>1?z-1:0),A=1;A<z;A++)_[A-1]=arguments[A];if(d=_,!(s&&h===n)){var g=t.leading;typeof g=="function"&&(g=g(h,n)),(!s||h!==n)&&g&&e.apply(void 0,[h].concat(Fe(d))),n=h,clearTimeout(s),s=setTimeout(function(){e.apply(void 0,[h].concat(Fe(d))),s=0},i)}};return c._clear=function(){clearTimeout(s),s=null},c}function Xe(e,i){if(e===i)return!0;if(ke(e)==="object"){for(var t in e)if(!Xe(e[t],i[t]))return!1;return!0}return!1}var Mt=function(){function e(i,t,s){_t(this,e),this.el=i,this.observer=null,this.frozen=!1,this.createObserver(t,s)}return Tt(e,[{key:"createObserver",value:function(t,s){var n=this;if(this.observer&&this.destroyObserver(),!this.frozen){if(this.options=Vt(t),this.callback=function(p,h){n.options.callback(p,h),p&&n.options.once&&(n.frozen=!0,n.destroyObserver())},this.callback&&this.options.throttle){var d=this.options.throttleOptions||{},c=d.leading;this.callback=Rt(this.callback,this.options.throttle,{leading:function(h){return c==="both"||c==="visible"&&h||c==="hidden"&&!h}})}this.oldResult=void 0,this.observer=new IntersectionObserver(function(p){var h=p[0];if(p.length>1){var z=p.find(function(A){return A.isIntersecting});z&&(h=z)}if(n.callback){var _=h.isIntersecting&&h.intersectionRatio>=n.threshold;if(_===n.oldResult)return;n.oldResult=_,n.callback(_,h)}},this.options.intersection),he(function(){n.observer&&n.observer.observe(n.el)})}}},{key:"destroyObserver",value:function(){this.observer&&(this.observer.disconnect(),this.observer=null),this.callback&&this.callback._clear&&(this.callback._clear(),this.callback=null)}},{key:"threshold",get:function(){return this.options.intersection&&typeof this.options.intersection.threshold=="number"?this.options.intersection.threshold:0}}]),e}();function Je(e,i,t){var s=i.value;if(s)if(typeof IntersectionObserver>"u")console.warn("[vue-observe-visibility] IntersectionObserver API is not available in your browser. Please install this polyfill: https://github.com/w3c/IntersectionObserver/tree/master/polyfill");else{var n=new Mt(e,s,t);e._vue_visibilityState=n}}function Lt(e,i,t){var s=i.value,n=i.oldValue;if(!Xe(s,n)){var d=e._vue_visibilityState;if(!s){Qe(e);return}d?d.createObserver(s,t):Je(e,{value:s},t)}}function Qe(e){var i=e._vue_visibilityState;i&&(i.destroyObserver(),delete e._vue_visibilityState)}var Kt={beforeMount:Je,updated:Lt,unmounted:Qe};function Pt(e){return{all:e=e||new Map,on:function(i,t){var s=e.get(i);s&&s.push(t)||e.set(i,[t])},off:function(i,t){var s=e.get(i);s&&s.splice(s.indexOf(t)>>>0,1)},emit:function(i,t){(e.get(i)||[]).slice().map(function(s){s(t)}),(e.get("*")||[]).slice().map(function(s){s(i,t)})}}}var Bt={itemsLimit:1e3},Ft=/(auto|scroll)/;function Ze(e,i){return e.parentNode===null?i:Ze(e.parentNode,i.concat([e]))}var Ne=function(i,t){return getComputedStyle(i,null).getPropertyValue(t)},Ut=function(i){return Ne(i,"overflow")+Ne(i,"overflow-y")+Ne(i,"overflow-x")},Ht=function(i){return Ft.test(Ut(i))};function Ue(e){if(e instanceof HTMLElement||e instanceof SVGElement){for(var i=Ze(e.parentNode,[]),t=0;t<i.length;t+=1)if(Ht(i[t]))return i[t];return document.scrollingElement||document.documentElement}}function Ve(e){"@babel/helpers - typeof";return Ve=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},Ve(e)}var et={items:{type:Array,required:!0},keyField:{type:String,default:"id"},direction:{type:String,default:"vertical",validator:function(i){return["vertical","horizontal"].includes(i)}},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"}};function tt(){return this.items.length&&Ve(this.items[0])!=="object"}var Re=!1;if(typeof window<"u"){Re=!1;try{var Wt=Object.defineProperty({},"passive",{get:function(){Re=!0}});window.addEventListener("test",null,Wt)}catch{}}let jt=0;var Le={name:"RecycleScroller",components:{ResizeObserver:xe},directives:{ObserveVisibility:Kt},props:{...et,itemSize:{type:Number,default:null},gridItems:{type:Number,default:void 0},itemSecondarySize:{type:Number,default:void 0},minItemSize:{type:[Number,String],default:null},sizeField:{type:String,default:"size"},typeField:{type:String,default:"type"},buffer:{type:Number,default:200},pageMode:{type:Boolean,default:!1},prerender:{type:Number,default:0},emitUpdate:{type:Boolean,default:!1},updateInterval:{type:Number,default:0},skipHover:{type:Boolean,default:!1},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"},listClass:{type:[String,Object,Array],default:""},itemClass:{type:[String,Object,Array],default:""}},emits:["resize","visible","hidden","update","scroll-start","scroll-end"],data(){return{pool:[],totalSize:0,ready:!1,hoverKey:null}},computed:{sizes(){if(this.itemSize===null){const e={"-1":{accumulator:0}},i=this.items,t=this.sizeField,s=this.minItemSize;let n=1e4,d=0,c;for(let p=0,h=i.length;p<h;p++)c=i[p][t]||s,c<n&&(n=c),d+=c,e[p]={accumulator:d,size:c};return this.$_computedMinItemSize=n,e}return[]},simpleArray:tt,itemIndexByKey(){const{keyField:e,items:i}=this,t={};for(let s=0,n=i.length;s<n;s++)t[i[s][e]]=s;return t}},watch:{items(){this.updateVisibleItems(!0)},pageMode(){this.applyPageMode(),this.updateVisibleItems(!1)},sizes:{handler(){this.updateVisibleItems(!1)},deep:!0},gridItems(){this.updateVisibleItems(!0)},itemSecondarySize(){this.updateVisibleItems(!0)}},created(){this.$_startIndex=0,this.$_endIndex=0,this.$_views=new Map,this.$_unusedViews=new Map,this.$_scrollDirty=!1,this.$_lastUpdateScrollPosition=0,this.prerender&&(this.$_prerender=!0,this.updateVisibleItems(!1)),this.gridItems&&!this.itemSize&&console.error("[vue-recycle-scroller] You must provide an itemSize when using gridItems")},mounted(){this.applyPageMode(),this.$nextTick(()=>{this.$_prerender=!1,this.updateVisibleItems(!0),this.ready=!0})},activated(){const e=this.$_lastUpdateScrollPosition;typeof e=="number"&&this.$nextTick(()=>{this.scrollToPosition(e)})},beforeUnmount(){this.removeListeners()},methods:{addView(e,i,t,s,n){const d=ht({id:jt++,index:i,used:!0,key:s,type:n}),c=ft({item:t,position:0,nr:d});return e.push(c),c},unuseView(e,i=!1){const t=this.$_unusedViews,s=e.nr.type;let n=t.get(s);n||(n=[],t.set(s,n)),n.push(e),i||(e.nr.used=!1,e.position=-9999)},handleResize(){this.$emit("resize"),this.ready&&this.updateVisibleItems(!1)},handleScroll(e){if(!this.$_scrollDirty){if(this.$_scrollDirty=!0,this.$_updateTimeout)return;const i=()=>requestAnimationFrame(()=>{this.$_scrollDirty=!1;const{continuous:t}=this.updateVisibleItems(!1,!0);t||(clearTimeout(this.$_refreshTimout),this.$_refreshTimout=setTimeout(this.handleScroll,this.updateInterval+100))});i(),this.updateInterval&&(this.$_updateTimeout=setTimeout(()=>{this.$_updateTimeout=0,this.$_scrollDirty&&i()},this.updateInterval))}},handleVisibilityChange(e,i){this.ready&&(e||i.boundingClientRect.width!==0||i.boundingClientRect.height!==0?(this.$emit("visible"),requestAnimationFrame(()=>{this.updateVisibleItems(!1)})):this.$emit("hidden"))},updateVisibleItems(e,i=!1){const t=this.itemSize,s=this.gridItems||1,n=this.itemSecondarySize||t,d=this.$_computedMinItemSize,c=this.typeField,p=this.simpleArray?null:this.keyField,h=this.items,z=h.length,_=this.sizes,A=this.$_views,g=this.$_unusedViews,S=this.pool,b=this.itemIndexByKey;let u,m,D,I,w;if(!z)u=m=I=w=D=0;else if(this.$_prerender)u=I=0,m=w=Math.min(this.prerender,h.length),D=null;else{const y=this.getScroll();if(i){let L=y.start-this.$_lastUpdateScrollPosition;if(L<0&&(L=-L),t===null&&L<d||L<t)return{continuous:!0}}this.$_lastUpdateScrollPosition=y.start;const V=this.buffer;y.start-=V,y.end+=V;let R=0;if(this.$refs.before&&(R=this.$refs.before.scrollHeight,y.start-=R),this.$refs.after){const L=this.$refs.after.scrollHeight;y.end+=L}if(t===null){let L,Y=0,se=z-1,F=~~(z/2),oe;do oe=F,L=_[F].accumulator,L<y.start?Y=F:F<z-1&&_[F+1].accumulator>y.start&&(se=F),F=~~((Y+se)/2);while(F!==oe);for(F<0&&(F=0),u=F,D=_[z-1].accumulator,m=F;m<z&&_[m].accumulator<y.end;m++);for(m===-1?m=h.length-1:(m++,m>z&&(m=z)),I=u;I<z&&R+_[I].accumulator<y.start;I++);for(w=I;w<z&&R+_[w].accumulator<y.end;w++);}else{u=~~(y.start/t*s);const L=u%s;u-=L,m=Math.ceil(y.end/t*s),I=Math.max(0,Math.floor((y.start-R)/t*s)),w=Math.floor((y.end-R)/t*s),u<0&&(u=0),m>z&&(m=z),I<0&&(I=0),w>z&&(w=z),D=Math.ceil(z/s)*t}}m-u>Bt.itemsLimit&&this.itemsLimitError(),this.totalSize=D;let l;const f=u<=this.$_endIndex&&m>=this.$_startIndex;if(f)for(let y=0,V=S.length;y<V;y++)l=S[y],l.nr.used&&(e&&(l.nr.index=b[l.item[p]]),(l.nr.index==null||l.nr.index<u||l.nr.index>=m)&&this.unuseView(l));const E=f?null:new Map;let v,C,O;for(let y=u;y<m;y++){v=h[y];const V=p?v[p]:v;if(V==null)throw new Error(`Key is ${V} on item (keyField is '${p}')`);if(l=A.get(V),!t&&!_[y].size){l&&this.unuseView(l);continue}C=v[c];let R=g.get(C),L=!1;if(!l)f?R&&R.length?l=R.pop():l=this.addView(S,y,v,V,C):(O=E.get(C)||0,(!R||O>=R.length)&&(l=this.addView(S,y,v,V,C),this.unuseView(l,!0),R=g.get(C)),l=R[O],E.set(C,O+1)),A.delete(l.nr.key),l.nr.used=!0,l.nr.index=y,l.nr.key=V,l.nr.type=C,A.set(V,l),L=!0;else if(!l.nr.used&&(l.nr.used=!0,L=!0,R)){const Y=R.indexOf(l);Y!==-1&&R.splice(Y,1)}l.item=v,L&&(y===h.length-1&&this.$emit("scroll-end"),y===0&&this.$emit("scroll-start")),t===null?(l.position=_[y-1].accumulator,l.offset=0):(l.position=Math.floor(y/s)*t,l.offset=y%s*n)}return this.$_startIndex=u,this.$_endIndex=m,this.emitUpdate&&this.$emit("update",u,m,I,w),clearTimeout(this.$_sortTimer),this.$_sortTimer=setTimeout(this.sortViews,this.updateInterval+300),{continuous:f}},getListenerTarget(){let e=Ue(this.$el);return window.document&&(e===window.document.documentElement||e===window.document.body)&&(e=window),e},getScroll(){const{$el:e,direction:i}=this,t=i==="vertical";let s;if(this.pageMode){const n=e.getBoundingClientRect(),d=t?n.height:n.width;let c=-(t?n.top:n.left),p=t?window.innerHeight:window.innerWidth;c<0&&(p+=c,c=0),c+p>d&&(p=d-c),s={start:c,end:c+p}}else t?s={start:e.scrollTop,end:e.scrollTop+e.clientHeight}:s={start:e.scrollLeft,end:e.scrollLeft+e.clientWidth};return s},applyPageMode(){this.pageMode?this.addListeners():this.removeListeners()},addListeners(){this.listenerTarget=this.getListenerTarget(),this.listenerTarget.addEventListener("scroll",this.handleScroll,Re?{passive:!0}:!1),this.listenerTarget.addEventListener("resize",this.handleResize)},removeListeners(){this.listenerTarget&&(this.listenerTarget.removeEventListener("scroll",this.handleScroll),this.listenerTarget.removeEventListener("resize",this.handleResize),this.listenerTarget=null)},scrollToItem(e){let i;const t=this.gridItems||1;this.itemSize===null?i=e>0?this.sizes[e-1].accumulator:0:i=Math.floor(e/t)*this.itemSize,this.scrollToPosition(i)},scrollToPosition(e){const i=this.direction==="vertical"?{scroll:"scrollTop",start:"top"}:{scroll:"scrollLeft",start:"left"};let t,s,n;if(this.pageMode){const d=Ue(this.$el),c=d.tagName==="HTML"?0:d[i.scroll],p=d.getBoundingClientRect(),z=this.$el.getBoundingClientRect()[i.start]-p[i.start];t=d,s=i.scroll,n=e+c+z}else t=this.$el,s=i.scroll,n=e;t[s]=n},itemsLimitError(){throw setTimeout(()=>{console.log("It seems the scroller element isn't scrolling, so it tries to render all the items at once.","Scroller:",this.$el),console.log("Make sure the scroller has a fixed height (or width) and 'overflow-y' (or 'overflow-x') set to 'auto' so it can scroll correctly and only render the items visible in the scroll viewport.")}),new Error("Rendered items limit reached")},sortViews(){this.pool.sort((e,i)=>e.nr.index-i.nr.index)}}};const qt={key:0,ref:"before",class:"vue-recycle-scroller__slot"},Yt={key:1,ref:"after",class:"vue-recycle-scroller__slot"};function Gt(e,i,t,s,n,d){const c=We("ResizeObserver"),p=vt("observe-visibility");return pt((H(),ee("div",{class:we(["vue-recycle-scroller",{ready:n.ready,"page-mode":t.pageMode,[`direction-${e.direction}`]:!0}]),onScrollPassive:i[0]||(i[0]=(...h)=>d.handleScroll&&d.handleScroll(...h))},[e.$slots.before?(H(),ee("div",qt,[q(e.$slots,"before")],512)):ge("v-if",!0),(H(),fe(Be(t.listTag),{ref:"wrapper",style:Me({[e.direction==="vertical"?"minHeight":"minWidth"]:n.totalSize+"px"}),class:we(["vue-recycle-scroller__item-wrapper",t.listClass])},{default:te(()=>[(H(!0),ee(qe,null,gt(n.pool,h=>(H(),fe(Be(t.itemTag),Ye({key:h.nr.id,style:n.ready?{transform:`translate${e.direction==="vertical"?"Y":"X"}(${h.position}px) translate${e.direction==="vertical"?"X":"Y"}(${h.offset}px)`,width:t.gridItems?`${e.direction==="vertical"&&t.itemSecondarySize||t.itemSize}px`:void 0,height:t.gridItems?`${e.direction==="horizontal"&&t.itemSecondarySize||t.itemSize}px`:void 0}:null,class:["vue-recycle-scroller__item-view",[t.itemClass,{hover:!t.skipHover&&n.hoverKey===h.nr.key}]]},mt(t.skipHover?{}:{mouseenter:()=>{n.hoverKey=h.nr.key},mouseleave:()=>{n.hoverKey=null}})),{default:te(()=>[q(e.$slots,"default",{item:h.item,index:h.nr.index,active:h.nr.used})]),_:2},1040,["style","class"]))),128)),q(e.$slots,"empty")]),_:3},8,["style","class"])),e.$slots.after?(H(),ee("div",Yt,[q(e.$slots,"after")],512)):ge("v-if",!0),je(c,{onNotify:d.handleResize},null,8,["onNotify"])],34)),[[p,d.handleVisibilityChange]])}Le.render=Gt;Le.__file="src/components/RecycleScroller.vue";var Ke={name:"DynamicScroller",components:{RecycleScroller:Le},provide(){return typeof ResizeObserver<"u"&&(this.$_resizeObserver=new ResizeObserver(e=>{requestAnimationFrame(()=>{if(Array.isArray(e)){for(const i of e)if(i.target&&i.target.$_vs_onResize){let t,s;if(i.borderBoxSize){const n=i.borderBoxSize[0];t=n.inlineSize,s=n.blockSize}else t=i.contentRect.width,s=i.contentRect.height;i.target.$_vs_onResize(i.target.$_vs_id,t,s)}}})})),{vscrollData:this.vscrollData,vscrollParent:this,vscrollResizeObserver:this.$_resizeObserver}},inheritAttrs:!1,props:{...et,minItemSize:{type:[Number,String],required:!0}},emits:["resize","visible"],data(){return{vscrollData:{active:!0,sizes:{},keyField:this.keyField,simpleArray:!1}}},computed:{simpleArray:tt,itemsWithSize(){const e=[],{items:i,keyField:t,simpleArray:s}=this,n=this.vscrollData.sizes,d=i.length;for(let c=0;c<d;c++){const p=i[c],h=s?c:p[t];let z=n[h];typeof z>"u"&&!this.$_undefinedMap[h]&&(z=0),e.push({item:p,id:h,size:z})}return e}},watch:{items(){this.forceUpdate()},simpleArray:{handler(e){this.vscrollData.simpleArray=e},immediate:!0},direction(e){this.forceUpdate(!0)},itemsWithSize(e,i){const t=this.$el.scrollTop;let s=0,n=0;const d=Math.min(e.length,i.length);for(let p=0;p<d&&!(s>=t);p++)s+=i[p].size||this.minItemSize,n+=e[p].size||this.minItemSize;const c=n-s;c!==0&&(this.$el.scrollTop+=c)}},beforeCreate(){this.$_updates=[],this.$_undefinedSizes=0,this.$_undefinedMap={},this.$_events=Pt()},activated(){this.vscrollData.active=!0},deactivated(){this.vscrollData.active=!1},unmounted(){this.$_events.all.clear()},methods:{onScrollerResize(){this.$refs.scroller&&this.forceUpdate(),this.$emit("resize")},onScrollerVisible(){this.$_events.emit("vscroll:update",{force:!1}),this.$emit("visible")},forceUpdate(e=!1){(e||this.simpleArray)&&(this.vscrollData.sizes={}),this.$_events.emit("vscroll:update",{force:!0})},scrollToItem(e){const i=this.$refs.scroller;i&&i.scrollToItem(e)},getItemSize(e,i=void 0){const t=this.simpleArray?i??this.items.indexOf(e):e[this.keyField];return this.vscrollData.sizes[t]||0},scrollToBottom(){if(this.$_scrollingToBottom)return;this.$_scrollingToBottom=!0;const e=this.$el;this.$nextTick(()=>{e.scrollTop=e.scrollHeight+5e3;const i=()=>{e.scrollTop=e.scrollHeight+5e3,requestAnimationFrame(()=>{e.scrollTop=e.scrollHeight+5e3,this.$_undefinedSizes===0?this.$_scrollingToBottom=!1:requestAnimationFrame(i)})};requestAnimationFrame(i)})}}};function Xt(e,i,t,s,n,d){const c=We("RecycleScroller");return H(),fe(c,Ye({ref:"scroller",items:d.itemsWithSize,"min-item-size":t.minItemSize,direction:e.direction,"key-field":"id","list-tag":e.listTag,"item-tag":e.itemTag},e.$attrs,{onResize:d.onScrollerResize,onVisible:d.onScrollerVisible}),{default:te(({item:p,index:h,active:z})=>[q(e.$slots,"default",yt(bt({item:p.item,index:h,active:z,itemWithSize:p})))]),before:te(()=>[q(e.$slots,"before")]),after:te(()=>[q(e.$slots,"after")]),empty:te(()=>[q(e.$slots,"empty")]),_:3},16,["items","min-item-size","direction","list-tag","item-tag","onResize","onVisible"])}Ke.render=Xt;Ke.__file="src/components/DynamicScroller.vue";var it={name:"DynamicScrollerItem",inject:["vscrollData","vscrollParent","vscrollResizeObserver"],props:{item:{required:!0},watchData:{type:Boolean,default:!1},active:{type:Boolean,required:!0},index:{type:Number,default:void 0},sizeDependencies:{type:[Array,Object],default:null},emitResize:{type:Boolean,default:!1},tag:{type:String,default:"div"}},emits:["resize"],computed:{id(){if(this.vscrollData.simpleArray)return this.index;if(this.vscrollData.keyField in this.item)return this.item[this.vscrollData.keyField];throw new Error(`keyField '${this.vscrollData.keyField}' not found in your item. You should set a valid keyField prop on your Scroller`)},size(){return this.vscrollData.sizes[this.id]||0},finalActive(){return this.active&&this.vscrollData.active}},watch:{watchData:"updateWatchData",id(e,i){if(this.$el.$_vs_id=this.id,this.size||this.onDataUpdate(),this.$_sizeObserved){const t=this.vscrollData.sizes[i],s=this.vscrollData.sizes[e];t!=null&&t!==s&&this.applySize(t)}},finalActive(e){this.size||(e?this.vscrollParent.$_undefinedMap[this.id]||(this.vscrollParent.$_undefinedSizes++,this.vscrollParent.$_undefinedMap[this.id]=!0):this.vscrollParent.$_undefinedMap[this.id]&&(this.vscrollParent.$_undefinedSizes--,this.vscrollParent.$_undefinedMap[this.id]=!1)),this.vscrollResizeObserver?e?this.observeSize():this.unobserveSize():e&&this.$_pendingVScrollUpdate===this.id&&this.updateSize()}},created(){if(!this.$isServer&&(this.$_forceNextVScrollUpdate=null,this.updateWatchData(),!this.vscrollResizeObserver)){for(const e in this.sizeDependencies)this.$watch(()=>this.sizeDependencies[e],this.onDataUpdate);this.vscrollParent.$_events.on("vscroll:update",this.onVscrollUpdate)}},mounted(){this.finalActive&&(this.updateSize(),this.observeSize())},beforeUnmount(){this.vscrollParent.$_events.off("vscroll:update",this.onVscrollUpdate),this.unobserveSize()},methods:{updateSize(){this.finalActive?this.$_pendingSizeUpdate!==this.id&&(this.$_pendingSizeUpdate=this.id,this.$_forceNextVScrollUpdate=null,this.$_pendingVScrollUpdate=null,this.computeSize(this.id)):this.$_forceNextVScrollUpdate=this.id},updateWatchData(){this.watchData&&!this.vscrollResizeObserver?this.$_watchData=this.$watch("item",()=>{this.onDataUpdate()},{deep:!0}):this.$_watchData&&(this.$_watchData(),this.$_watchData=null)},onVscrollUpdate({force:e}){!this.finalActive&&e&&(this.$_pendingVScrollUpdate=this.id),(this.$_forceNextVScrollUpdate===this.id||e||!this.size)&&this.updateSize()},onDataUpdate(){this.updateSize()},computeSize(e){this.$nextTick(()=>{if(this.id===e){const i=this.$el.offsetWidth,t=this.$el.offsetHeight;this.applyWidthHeight(i,t)}this.$_pendingSizeUpdate=null})},applyWidthHeight(e,i){const t=~~(this.vscrollParent.direction==="vertical"?i:e);t&&this.size!==t&&this.applySize(t)},applySize(e){this.vscrollParent.$_undefinedMap[this.id]&&(this.vscrollParent.$_undefinedSizes--,this.vscrollParent.$_undefinedMap[this.id]=void 0),this.vscrollData.sizes[this.id]=e,this.emitResize&&this.$emit("resize",this.id)},observeSize(){this.vscrollResizeObserver&&(this.$_sizeObserved||(this.vscrollResizeObserver.observe(this.$el),this.$el.$_vs_id=this.id,this.$el.$_vs_onResize=this.onResize,this.$_sizeObserved=!0))},unobserveSize(){this.vscrollResizeObserver&&this.$_sizeObserved&&(this.vscrollResizeObserver.unobserve(this.$el),this.$el.$_vs_onResize=void 0,this.$_sizeObserved=!1)},onResize(e,i,t){this.id===e&&this.applyWidthHeight(i,t)}},render(){return St(this.tag,this.$slots.default())}};it.__file="src/components/DynamicScrollerItem.vue";const me={id:"id",children:"children",label:"label",disabled:"disabled",isLeaf:"isLeaf"};function J(e,i={}){const t={...me,...i};return e[t.id]??e.id??""}function $e(e,i={}){const t={...me,...i};return e[t.label]??e.label??""}function ie(e,i={}){const t={...me,...i};return e[t.children]??e.children??[]}function Jt(e,i={}){const t={...me,...i};return e[t.disabled]??e.disabled??!1}function ve(e,i={}){const t={...me,...i};return ie(e,i).length>0?!1:e[t.isLeaf]!==void 0?e[t.isLeaf]??!1:!0}function st(e,i,t=null,s={}){for(const n of e){if(i(n,t)===!1)continue;const c=ie(n,s);c.length>0&&st(c,i,n,s)}}function nt(e,i,t={}){for(const s of e){if(i(s))return s;const n=ie(s,t);if(n.length>0){const d=nt(n,i,t);if(d)return d}}return null}function Ee(e,i,t={}){return nt(e,s=>J(s,t)===i,t)}function Qt(e,i={}){const t=[];return st(e,s=>{t.push(J(s,i))},null,i),t}const Zt=["draggable","data-node-id","data-node-index"],ei={class:"vue-virtual-tree-node__content"},ti={key:0},ii={key:0,class:"vue-virtual-tree-node__checkbox"},si=["checked","indeterminate","disabled"],ni={class:"vue-virtual-tree-node__label"},ri=Ge({__name:"TreeNode",props:{node:{},props:{},index:{},showCheckbox:{type:Boolean},expandOnClickNode:{type:Boolean},draggable:{type:Boolean},currentKey:{},dropType:{},indent:{type:[Number,Function]}},emits:["drag-start","drag-enter","drag-leave","drag-over","drag-end","drop"],setup(e,{emit:i}){const t=e,s=i,n=j(!1),d=le(()=>$e(t.node.data,t.props)),c=le(()=>ve(t.node.data,t.props)),p=le(()=>t.currentKey!==null&&t.currentKey!==void 0&&t.currentKey===t.node.id),h=le(()=>{const u=t.indent;if(typeof u=="function")try{return u(t.node)??18}catch{return 18}return u??18}),z=u=>{t.node.isDisabled||!t.draggable||(n.value=!0,s("drag-start",t.node,u))},_=u=>{t.draggable&&s("drag-enter",t.node,u)},A=u=>{t.draggable&&s("drag-leave",t.node,u)},g=u=>{t.draggable&&s("drag-over",t.node,u)},S=u=>{n.value=!1,s("drag-end",t.node,u)},b=u=>{t.draggable&&s("drop",t.node,u)};return(u,m)=>(H(),ee("div",{class:we(["vue-virtual-tree-node",{"is-expanded":e.node.isExpanded,"is-checked":e.node.isChecked,"is-disabled":e.node.isDisabled,"is-leaf":c.value,"is-loading":e.node.isLoading,"is-dragging":n.value,"is-current":p.value,[`drop-${e.dropType}`]:e.dropType}]),style:Me({paddingLeft:`${e.node.level*h.value}px`}),draggable:e.draggable&&!e.node.isDisabled,"data-node-id":e.node.id,"data-node-index":e.index,onDragstart:z,onDragenter:_,onDragleave:A,onDragover:g,onDragend:S,onDrop:b},[G("div",ei,[G("span",{class:we(["vue-virtual-tree-node__expand-icon",{"is-leaf":c.value,"is-loading":e.node.isLoading}])},[e.node.isLoading?(H(),ee("span",ti,[q(u.$slots,"loading",{node:e.node,data:e.node.data},void 0,!0)])):q(u.$slots,"icon",{key:1,node:e.node,data:e.node.data},void 0,!0)],2),e.showCheckbox?(H(),ee("span",ii,[G("input",{type:"checkbox",checked:e.node.isChecked,indeterminate:e.node.isIndeterminate,disabled:e.node.isDisabled},null,8,si)])):ge("",!0),G("span",ni,[q(u.$slots,"default",{node:e.node,data:e.node.data},()=>[zt(kt(d.value),1)],!0)])])],46,Zt))}}),rt=(e,i)=>{const t=e.__vccOpts||e;for(const[s,n]of i)t[s]=n;return t},li=rt(ri,[["__scopeId","data-v-e4f33346"]]);function ai(e,i,t,s){const n=le(()=>{const l=new Set;return i.value.forEach(f=>{f.isChecked&&l.add(f.id)}),l}),d=le(()=>{const l=new Set;return i.value.forEach(f=>{f.isIndeterminate&&l.add(f.id)}),l}),c=j(null),p=j(null),h=()=>{i.value.forEach(l=>{l.isChecked=!1,l.isIndeterminate=!1}),e.defaultCheckedKeys&&e.defaultCheckedKeys.length>0&&e.defaultCheckedKeys.forEach(l=>{s(l)&&S(l,!0)})},z=()=>{if(e.currentNodeKey!==void 0){c.value=e.currentNodeKey;const l=t(e.currentNodeKey);p.value=l}},_=l=>{const f=[],E=t(l);if(!E)return f;const v=C=>{ie(C,e.props).forEach(y=>{const V=J(y,e.props);f.push(V),v(y)})};return v(E),f},A=()=>{d.value.clear();const l=new Set(i.value.map(f=>f.id));for(const f of l){const E=_(f);if(E.length===0)continue;const v=E.filter(C=>n.value.has(C));v.length>0&&v.length<E.length&&d.value.add(f)}},g=(l,f)=>{l.isChecked=f,l.isIndeterminate=!1;const E=(C,O)=>{C.children&&C.children.forEach(y=>{y.isChecked=O,y.isIndeterminate=!1,E(y,O)})};E(l,f);const v=C=>{const O=C.parentId;if(O!==null){const y=s(O);if(y){const V=y.children||[],R=V.filter(Y=>Y.isChecked).length,L=V.filter(Y=>Y.isIndeterminate).length;R===V.length?(y.isChecked=!0,y.isIndeterminate=!1):R===0&&L===0?(y.isChecked=!1,y.isIndeterminate=!1):(y.isChecked=!1,y.isIndeterminate=!0),v(y)}}};v(l)},S=(l,f,E)=>{const v=s(l);if(!v)return;E??e.checkStrictly??!1?(v.isChecked=f,v.isIndeterminate=!1):g(v,f)},b=l=>{const f=n.value.has(l);S(l,!f)},u=(l,f=null)=>{c.value=l,p.value=f},m=(l=!1,f=!1)=>{const E=[],v=f?new Set([...n.value,...d.value]):n.value;for(const C of v){const O=t(C);O&&(l?ie(O,e.props).length===0&&E.push(O):E.push(O))}return E},D=(l=!1)=>l?m(!0).map(E=>J(E,e.props)):Array.from(n.value),I=(l,f=!1)=>{n.value.clear(),l.filter(v=>f?ve(v,e.props):!0).map(v=>J(v,e.props)).forEach(v=>{S(v,!0)}),e.checkStrictly||A()},w=(l,f=!1)=>{n.value.clear(),(f?l.filter(v=>{const C=t(v);return C&&ve(C,e.props)}):l).forEach(v=>{S(v,!0)}),e.checkStrictly||A()};return z(),Se(()=>e.currentNodeKey,l=>{l!==void 0&&u(l,t(l))}),{checkedKeys:n,halfCheckedKeys:d,selectedKey:c,currentNode:p,initNodeChecked:h,setNodeChecked:S,toggleNodeChecked:b,setCurrentNode:u,getCheckedNodes:m,getCheckedKeys:D,setCheckedNodes:I,setCheckedKeys:w,updateHalfCheckedKeys:A}}function He(e,i){if(!Array.isArray(e)||e.length===0)return-1;let t=0,s=e.length-1;for(;t<=s;){const n=t+Math.floor((s-t)/2),d=e[n].index;if(d===i)return n;(d??-1/0)<i?t=n+1:s=n-1}return-1}function oi(e,i,t){const s=j(new Set),n=()=>{if(e.defaultExpandAll){const g=Qt(e.data,e.props);s.value=new Set(g)}else e.defaultExpandedKeys&&e.defaultExpandedKeys.length>0?s.value=new Set(e.defaultExpandedKeys):s.value=new Set},d=g=>{const S=[];return g.children&&g.children.forEach(b=>{S.push(b),b.isExpanded&&S.push(...d(b))}),S},c=g=>{typeof g.visibleIndex!="number"&&(g.visibleIndex=He(t.value,g.index));const S=d(g);S.length!==0&&t.value.splice(g.visibleIndex+1,0,...S)},p=g=>{typeof g.visibleIndex!="number"&&(g.visibleIndex=He(t.value,g.index));const S=d(g);S.length!==0&&t.value.splice(g.visibleIndex+1,S.length)},h=g=>{e.accordion&&i.value.filter(b=>b.parentId===g.parentId&&b.id!==g.id&&b.isExpanded).forEach(b=>{b.isExpanded=!1,s.value.delete(b.id),p(b)}),g.isExpanded=!0,s.value.add(g.id),c(g)},z=(g,S)=>{g.isExpanded=S,s.value.delete(g.id),g.children&&g.children.forEach(b=>{z(b,S)})},_=g=>{p(g),z(g,!1)};return{expandedKeys:s,initExpandedKeys:n,expandNode:h,collapseNode:_,toggleNode:g=>{g.isExpanded?_(g):h(g)}}}function De(e){if(e.length<=1)return e;const i=Math.floor(e.length/2),t=De(e.slice(0,i)),s=De(e.slice(i));return di(t,s)}function di(e,i){const t=[];let s=0,n=0;for(;s<e.length&&n<i.length;)e[s].index<=i[n].index?(t.push(e[s]),s++):(t.push(i[n]),n++);for(;s<e.length;)t.push(e[s]),s++;for(;n<i.length;)t.push(i[n]),n++;return t}function ci(e,i,t,s,n,d,c,p){const h=()=>{const b=i.value.filter(D=>D.parentId===null),u=[],m=D=>{u.push(D),D.isExpanded&&D.children&&D.children.forEach(I=>m(I))};b.forEach(D=>m(D)),p(u)},z=(b,u)=>b?$e(u,e.props).toLowerCase().includes(b.toLowerCase()):!0,_=b=>({...b,children:void 0}),A=j(""),g=b=>(A.value=b,s.value=[],n.value=new Map,b?(d.value=!0,c.value.clear(),new Promise(async u=>{const m=e.filterNodeMethod||z,D=new Map;i.value.forEach(w=>{if(m(b,w.data)){D.has(w.id)||D.set(w.id,_(w));let l=w.parentId;for(;l;){const f=t.value.get(l);f&&!D.has(l)&&D.set(l,_(f)),l=(f==null?void 0:f.parentId)||null}}}),D.forEach(w=>{n.value.set(w.id,w);const l=[];D.forEach(f=>{f.parentId===w.id&&l.push(f)}),l.length>0?(w.children=De(l),w.isExpanded=!0,c.value.add(w.id)):(w.children=void 0,w.isLeaf=!0)});const I=De(Array.from(D.values()));p(I),s.value=I,u(void 0)})):(d.value=!1,i.value.forEach(u=>{u.isLeaf||(u.isExpanded=!0,c.value.add(u.id))}),h(),Promise.resolve()));return{filterText:A,filter:g,clearFilter:()=>{g("")}}}function ui(e,i){const t=j(null),s=j(null),n=j(null),d=S=>!0,c=(S,b,u,m)=>{if(u==="inner"){const D=J(S,m.props),I=w=>J(w,m.props)===D?!0:ie(w,m.props).some(f=>I(f));return!I(b)}return!0};return{draggingNode:t,dropNode:s,dropType:n,handleDragStart:(S,b)=>{t.value=S,b.dataTransfer&&(b.dataTransfer.effectAllowed="move")},handleDragEnter:(S,b)=>{if(!t.value)return;const u=i(t.value.id),m=i(S.id);if(!u||!m||!(e.allowDrag||d)(u))return;s.value=S;const I=b.currentTarget.getBoundingClientRect(),w=b.clientY-I.top,l=I.height,f=l/3;if(w<f?n.value="prev":w>l-f?n.value="next":n.value="inner",!(e.allowDrop||((v,C,O)=>c(v,C,O,e)))(u,m,n.value)){n.value=null;return}b.preventDefault()},handleDragLeave:(S,b)=>{var m;const u=b.relatedTarget;u&&b.currentTarget.contains(u)||((m=s.value)==null?void 0:m.id)===S.id&&(s.value=null,n.value=null)},handleDragOver:(S,b)=>{if(!t.value||!s.value||s.value.id!==S.id)return;const u=i(t.value.id),m=i(S.id);if(!u||!m)return;const D=b.currentTarget.getBoundingClientRect(),I=b.clientY-D.top,w=D.height,l=w/3;let f;if(I<l?f="prev":I>w-l?f="next":f="inner",!(e.allowDrop||((v,C,O)=>c(v,C,O,e)))(u,m,f)){n.value=null,b.preventDefault();return}n.value=f,b.preventDefault()},handleDragEnd:(S,b)=>{t.value=null,s.value=null,n.value=null},handleDrop:(S,b)=>{if(!t.value||!s.value||n.value===null)return;const u=i(t.value.id),m=i(S.id);if(!u||!m||!(e.allowDrop||((w,l,f)=>c(w,l,f,e)))(u,m,n.value))return;t.value=null,s.value=null;const I=n.value;return n.value=null,{draggingNode:u,dropNode:m,dropType:I}}}}function hi(e,i){const t=j([]),s=j(e.data),n=j(new Map),d=j([]),c=j([]),p=j(new Map),h=j(!1),z=le(()=>h.value?c.value:t.value),_=le(()=>h.value?p.value:n.value),A=K=>{d.value=K},g=K=>{const Z=_.value.get(K);return Z?Z.data:null},S=K=>_.value.get(K)||null,{checkedKeys:b,halfCheckedKeys:u,selectedKey:m,currentNode:D,toggleNodeChecked:I,setCurrentNode:w,getCheckedNodes:l,getCheckedKeys:f,setCheckedNodes:E,setCheckedKeys:v,initNodeChecked:C}=ai(e,t,g,S),{expandNode:O,collapseNode:y,expandedKeys:V,initExpandedKeys:R}=oi(e,z,d),{filter:L}=ci(e,t,n,c,p,h,V,A),Y=ui(e,g),se=(K,Z=0,W=null,de=0,ye=!0,r)=>{const a=new Map,o=[];function k(N,U=0,M=null,x=0,P=!0,X=[],B){const _e=[];let re=N.length;for(let Ce=0;Ce<re;Ce++){x++;const pe=N[Ce],Te=J(pe,B),be=ie(pe,B),Pe=V.value.has(Te),lt=ve(pe,B),ce={id:Te,data:pe,level:U,parentId:(M==null?void 0:M.id)||null,index:x,isExpanded:Pe,isDisabled:Jt(pe,B),isLeaf:lt,isLoading:!1,isLoaded:!1,isChecked:!1,rawChildren:be.length>0?be:void 0};if(_e.push(ce),X.push(ce),P&&o.push(ce),be.length>0){const{nodes:at,index:ot}=k(be,U+1,ce,x,Pe&&P,X,B);ce.children=at,x=ot}a.set(Te,ce)}return{nodes:_e,index:x}}const $=[],{nodes:T}=k(K,Z,W,de,ye,$,r);return{nodes:T,flatNodes:$,nodeMap:a,visibleNodes:o}};let F=!1;const oe=()=>{if(F)return;F=!0;const{flatNodes:K,nodeMap:Z,visibleNodes:W}=se(s.value,0,null,0,!0,e.props);t.value=K,n.value=Z,A(W),F=!1},Ie=(K,Z)=>{const{nodes:W,flatNodes:de,nodeMap:ye}=se(Z,K.level+1,K,K.index+1,!0,e.props);K.children=W,ye.forEach((r,a)=>{n.value.set(a,r)}),t.value.splice(K.index+1,0,...de),requestAnimationFrame(()=>{for(let r=K.index+de.length;r<t.value.length;r++){const a=t.value[r];a.index=r}})},Q={needEmit:!0,resetExpanded:!0,resetChecked:!0};Se(()=>e.data,K=>{s.value=K,Q.needEmit=!0,Q.resetChecked=!0,ae()},{deep:!0}),Se(()=>[e.defaultExpandedKeys,e.defaultExpandAll],()=>{Q.resetExpanded=!0,ae()},{deep:!0,immediate:!1}),Se(()=>e.defaultCheckedKeys,()=>{Q.resetChecked=!0,ae()},{deep:!0,immediate:!1});let ne=null;const ae=()=>{ne&&clearTimeout(ne),ne=setTimeout(()=>{Q.resetExpanded&&R(),oe(),Q.resetChecked&&C(),Q.needEmit&&he(()=>{i("node-generated")}),Q.needEmit=!1,Q.resetExpanded=!1,Q.resetChecked=!1,ne=null},5)};return ae(),wt(()=>{ne&&(clearTimeout(ne),ne=null)}),{flatTree:t,visibleNodes:d,expandedKeys:V,checkedKeys:b,rawData:s,getNodeData:g,getFlatNode:S,regenerateFlatTree:ae,flattenTree:se,insertFlatTree:Ie,halfCheckedKeys:u,selectedKey:m,currentNode:D,toggleNodeChecked:I,setCurrentNode:w,getCheckedNodes:l,getCheckedKeys:f,setCheckedNodes:E,setCheckedKeys:v,expandNode:O,collapseNode:y,dragState:Y,filter:L}}const fi={key:0,class:"vue-virtual-tree__loading"},vi={class:"default-icon"},pi={key:0,viewBox:"0 0 1024 1024",width:"16",height:"16"},gi={key:1,class:"vue-virtual-tree__empty"},mi=Ge({name:"VirtualTree",__name:"VirtualTree",props:{data:{default:()=>[]},props:{default:()=>({})},showCheckbox:{type:Boolean,default:!1},checkStrictly:{type:Boolean,default:!1},defaultExpandAll:{type:Boolean,default:!1},defaultExpandedKeys:{default:()=>[]},defaultCheckedKeys:{default:()=>[]},currentNodeKey:{},expandOnClickNode:{type:Boolean,default:!0},lazy:{type:Boolean,default:!1},load:{},filterNodeMethod:{},accordion:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},allowDrop:{},allowDrag:{},itemSize:{default:32},height:{default:"100%"},indent:{type:[Number,Function],default:18},loading:{type:Boolean,default:!1}},emits:["node-click","node-check","node-expand","node-collapse","current-change","node-drag-start","node-drag-enter","node-drag-leave","node-drag-over","node-drag-end","node-drop","node-generated"],setup(e,{expose:i,emit:t}){const s=e,n=t,{visibleNodes:d,rawData:c,getNodeData:p,getFlatNode:h,regenerateFlatTree:z,insertFlatTree:_,checkedKeys:A,halfCheckedKeys:g,selectedKey:S,currentNode:b,toggleNodeChecked:u,setCurrentNode:m,getCheckedNodes:D,getCheckedKeys:I,setCheckedNodes:w,setCheckedKeys:l,expandNode:f,collapseNode:E,dragState:v,filter:C}=hi(s,n),O=j(null),y=r=>[r.data,r.isExpanded,r.isChecked,r.isLoading,r.isDisabled,r.level,$e(r.data,s.props)],V=r=>{const a=r.target;if(!a)return null;const o=a.closest("[data-node-id]");if(!o)return null;const k=o.getAttribute("data-node-id"),$=o.getAttribute("data-node-index");if(!k)return null;const T=isNaN(Number(k))?k:Number(k),N=isNaN(Number($))?void 0:Number($),U=h(T);return U&&(U.visibleIndex=N),U},R=r=>{const a=V(r);if(!a)return;const o=r.target;if(!o)return;const k=o.closest(".vue-virtual-tree-node__expand-icon"),$=o.closest(".vue-virtual-tree-node__checkbox"),T=o.closest(".vue-virtual-tree-node__content");$?F(a):k?a.isExpanded?se(a):Y(a):T&&(L(a,r),s.expandOnClickNode&&!ve(a.data,s.props)&&(a.isExpanded?se(a):Y(a)))},L=(r,a)=>{r.isDisabled||(m(r.id,r.data),n("current-change",r.data,W(r)),n("node-click",r.data,W(r),a))},Y=async r=>{if(!r.isDisabled){if(s.lazy&&!r.isLoaded&&s.load){let a=function(){r.isLoading=!1,r.isLoaded=!0};r.isLoading=!0,r.isLoaded=!1;try{await new Promise(o=>{s.load(r.data,k=>{k&&k.length>0&&_(r,k),a(),o()})})}catch(o){a(),console.error("Lazy load error:",o)}}f(r),n("node-expand",r.data,W(r))}},se=r=>{r.isDisabled||(E(r),n("node-collapse",r.data,W(r)))},F=r=>{if(r.isDisabled)return;u(r.id);const a=D(),o=I(),k=D(!1,!0).filter(T=>{const N=J(T,s.props);return g.value.has(N)&&!A.value.has(N)}),$=Array.from(g.value).filter(T=>!A.value.has(T));n("node-check",r.data,{checkedKeys:o,checkedNodes:a,halfCheckedKeys:$,halfCheckedNodes:k})},oe=(r,a)=>{v.handleDragStart(r,a),n("node-drag-start",r.data,a)},Ie=(r,a)=>{var o,k,$;v.handleDragEnter(r,a),((k=(o=v.dropNode)==null?void 0:o.value)==null?void 0:k.id)===r.id&&(($=v.draggingNode)!=null&&$.value)&&n("node-drag-enter",v.draggingNode.value.data,a,r.data)},Q=(r,a)=>{var o;v.handleDragLeave(r,a),(o=v.draggingNode)!=null&&o.value&&n("node-drag-leave",v.draggingNode.value.data,a,r.data)},ne=(r,a)=>{var o,k,$;v.handleDragOver(r,a),((k=(o=v.dropNode)==null?void 0:o.value)==null?void 0:k.id)===r.id&&(($=v.draggingNode)!=null&&$.value)&&n("node-drag-over",v.draggingNode.value.data,a,r.data)},ae=(r,a)=>{var o;(o=v.draggingNode)!=null&&o.value&&n("node-drag-end",v.draggingNode.value.data,a),v.handleDragEnd(r,a)},K=(r,a)=>{const o=v.handleDrop(r,a);o&&n("node-drop",o.draggingNode,o.dropNode,o.dropType,a)},Z=new WeakMap,W=r=>{if(Z.has(r))return Z.get(r);let a=null,o=null;const k=()=>{if(a!==null)return a;if(r.parentId===null)return a=null,null;const x=h(r.parentId);return x?(a=W(x),a):(a=null,null)},$=()=>(o!==null||(o=d.value.filter(P=>P.parentId===r.id).map(P=>W(P))),o),T=()=>d.value.filter(P=>P.parentId===r.parentId&&P.id!==r.id).map(P=>W(P)),N=()=>{const x=[],P=new Set,X=B=>{d.value.filter(re=>re.parentId===B).forEach(re=>{P.has(re.id)||(P.add(re.id),x.push(W(re)),X(re.id))})};return X(r.id),x},U=()=>{const x=[],P=new Set;let X=r.parentId;for(;X!==null&&!P.has(X);){P.add(X);const B=h(X);if(B)x.push(W(B)),X=B.parentId;else break}return x},M={data:r.data,key:r.id,level:r.level,get parent(){return k()},get children(){return $()},expanded:r.isExpanded,checked:r.isChecked||!1,disabled:r.isDisabled||!1,isLeaf:ve(r.data,s.props),getLabel:()=>$e(r.data,s.props),getData:()=>r.data,getParent:k,getChildren:$,getSiblings:T,getAllChildren:N,getAllParents:U};return Z.set(r,M),M},de=r=>{const a=h(r);return a?W(a):null};return i({getCheckedNodes:(r,a)=>D(r,a),getCheckedKeys:r=>I(r),setCheckedNodes:(r,a)=>{w(r,a)},setCheckedKeys:(r,a)=>{l(r,a)},getCurrentNode:()=>b.value,setCurrentNode:r=>{if(typeof r=="string"||typeof r=="number"){const a=p(r);m(r,a)}else{const a=J(r,s.props);m(a,r)}},getCurrentKey:()=>S.value,setCurrentKey:r=>{m(r,p(r))},filter:r=>C(r).then(()=>{he(()=>{var a,o;(a=O.value)==null||a.scrollToItem(0),(o=O.value)==null||o.forceUpdate()})}),getNode:r=>de(r),remove:r=>{if(!Ee(c.value,r,s.props))return;const o=(k,$)=>{for(let T=0;T<k.length;T++){if(J(k[T],s.props)===$)return k.splice(T,1),!0;const N=ie(k[T],s.props);if(N.length>0&&o(N,$))return!0}return!1};o(c.value,r),z()},append:(r,a)=>{if(a===void 0)c.value.push(r);else{const o=Ee(c.value,a,s.props);if(o){const $=(s.props||{}).children||"children";o[$]||(o[$]=[]),o[$].push(r)}}z()},insertBefore:(r,a)=>{const o=(k,$,T)=>{for(let N=0;N<k.length;N++){if(J(k[N],s.props)===$)return k.splice(N,0,T),!0;const U=ie(k[N],s.props);if(U.length>0&&o(U,$,T))return!0}return!1};o(c.value,a,r),z()},insertAfter:(r,a)=>{const o=(k,$,T)=>{for(let N=0;N<k.length;N++){if(J(k[N],s.props)===$)return k.splice(N+1,0,T),!0;const U=ie(k[N],s.props);if(U.length>0&&o(U,$,T))return!0}return!1};o(c.value,a,r),z()},updateKeyChildren:(r,a)=>{const o=Ee(c.value,r,s.props);if(o){const $=(s.props||{}).children||"children";o[$]=a,z()}},scrollToNode:(r,a)=>{let o;typeof r=="string"||typeof r=="number"?o=r:o=J(r,s.props);const k=h(o);if(!k){console.warn(`[VirtualTree] Node with key "${o}" not found`);return}const $=[],T=M=>{if(M.parentId!==null){const x=h(M.parentId);x&&!x.isExpanded&&($.push(x),T(x))}},N=async M=>{for(T(M);$.length>0;){const x=$.pop();x&&(await Y(x),await he())}};(async()=>{await N(k),await he();const M=d.value.findIndex(x=>x.id===o);if(M===-1){console.warn(`[VirtualTree] Node with key "${o}" is not visible`);return}if(O.value){const x=(a==null?void 0:a.align)||"top",P=(a==null?void 0:a.offset)||0,X={top:"start",center:"center",bottom:"end"},B=O.value;B&&typeof B.scrollToItem=="function"&&(P!==0?B.scrollToItem(M,X[x],P):x!=="top"?B.scrollToItem(M,X[x]):B.scrollToItem(M)),typeof B.forceUpdate=="function"&&B.forceUpdate()}})()}}),(r,a)=>(H(),ee("div",{class:"vue-virtual-tree",style:Me({height:typeof e.height=="number"?`${e.height}px`:e.height}),onClick:R},[e.loading?q(r.$slots,"tree-loading",{key:0},()=>[e.loading?(H(),ee("div",fi,[...a[0]||(a[0]=[G("span",{class:"vue-virtual-tree-loading-text"},"加载中...",-1)])])):ge("",!0)],!0):(H(),ee(qe,{key:1},[e.data.length>0?(H(),fe(ue(Ke),{key:0,ref_key:"dynamicScrollerRef",ref:O,items:ue(d),"min-item-size":e.itemSize||32,class:"vue-virtual-tree__scroller"},{default:te(({item:o,index:k,active:$})=>[je(ue(it),{item:o,active:$,"data-index":k,"size-dependencies":y(o),class:"vue-virtual-tree__item"},{default:te(()=>{var T,N,U;return[(H(),fe(li,{node:o,key:o.id,index:k,props:s.props,"show-checkbox":e.showCheckbox,"expand-on-click-node":e.expandOnClickNode,draggable:e.draggable,indent:s.indent,"current-key":ue(S),"drop-type":((N=(T=ue(v).dropNode)==null?void 0:T.value)==null?void 0:N.id)===o.id?((U=ue(v).dropType)==null?void 0:U.value)??null:null,onDragStart:oe,onDragEnter:Ie,onDragLeave:Q,onDragOver:ne,onDragEnd:ae,onDrop:K},{default:te(({node:M,data:x})=>[q(r.$slots,"default",{node:M,data:x},void 0,!0)]),loading:te(({node:M,data:x})=>[q(r.$slots,"loading",{node:M,data:x},()=>[a[1]||(a[1]=G("svg",{class:"vue-virtual-tree-node__loading-icon",viewBox:"0 0 24 24",width:"16",height:"16"},[G("g",{transform:"translate(12,12)"},[G("circle",{cx:"0",cy:"0",r:"8",fill:"none",stroke:"currentColor","stroke-width":"1",opacity:"0.2"}),G("g",{class:"vue-virtual-tree-loading-dots"},[G("circle",{cx:"0",cy:"-8",r:"2",fill:"currentColor"}),G("circle",{cx:"6.928",cy:"-4",r:"2",fill:"currentColor",opacity:"0.7"}),G("circle",{cx:"6.928",cy:"4",r:"2",fill:"currentColor",opacity:"0.4"})])])],-1))],!0)]),icon:te(({node:M,data:x})=>[q(r.$slots,"icon",{node:M,data:x},()=>[G("span",vi,[M.isLeaf?ge("",!0):(H(),ee("svg",pi,[...a[2]||(a[2]=[G("path",{d:"M384 384l256 256-256 256z",fill:"currentColor"},null,-1)])]))])],!0)]),_:3},8,["node","index","props","show-checkbox","expand-on-click-node","draggable","indent","current-key","drop-type"]))]}),_:2},1032,["item","active","data-index","size-dependencies"])]),_:3},8,["items","min-item-size"])):(H(),ee("div",gi,[q(r.$slots,"empty",{},()=>[a[3]||(a[3]=G("span",null,"暂无数据",-1))],!0)]))],64))],4))}}),bi=rt(mi,[["__scopeId","data-v-0f732415"]]);export{bi as V,rt as _};

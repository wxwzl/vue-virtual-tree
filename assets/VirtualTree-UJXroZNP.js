import{n as he,p as dt,q as ct,s as ut,x as fe,o as U,y as ht,z as ft,A as He,B as vt,w as pt,c as J,b as me,f as We,C as W,h as Z,F as je,j as gt,D as Be,E as qe,G as mt,H as Le,I as we,J as yt,K as bt,L as St,d as Ye,r as H,M as ne,a as Y,e as zt,t as kt,g as Se,N as wt,u as ue}from"./index-DA7tdZM0.js";function $t(){var e=window.navigator.userAgent,i=e.indexOf("MSIE ");if(i>0)return parseInt(e.substring(i+5,e.indexOf(".",i)),10);var t=e.indexOf("Trident/");if(t>0){var s=e.indexOf("rv:");return parseInt(e.substring(s+3,e.indexOf(".",s)),10)}var r=e.indexOf("Edge/");return r>0?parseInt(e.substring(r+5,e.indexOf(".",r)),10):-1}let ze;function Oe(){Oe.init||(Oe.init=!0,ze=$t()!==-1)}var _e={name:"ResizeObserver",props:{emitOnMount:{type:Boolean,default:!1},ignoreWidth:{type:Boolean,default:!1},ignoreHeight:{type:Boolean,default:!1}},emits:["notify"],mounted(){Oe(),he(()=>{this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitOnMount&&this.emitSize()});const e=document.createElement("object");this._resizeObject=e,e.setAttribute("aria-hidden","true"),e.setAttribute("tabindex",-1),e.onload=this.addResizeHandlers,e.type="text/html",ze&&this.$el.appendChild(e),e.data="about:blank",ze||this.$el.appendChild(e)},beforeUnmount(){this.removeResizeHandlers()},methods:{compareAndNotify(){(!this.ignoreWidth&&this._w!==this.$el.offsetWidth||!this.ignoreHeight&&this._h!==this.$el.offsetHeight)&&(this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitSize())},emitSize(){this.$emit("notify",{width:this._w,height:this._h})},addResizeHandlers(){this._resizeObject.contentDocument.defaultView.addEventListener("resize",this.compareAndNotify),this.compareAndNotify()},removeResizeHandlers(){this._resizeObject&&this._resizeObject.onload&&(!ze&&this._resizeObject.contentDocument&&this._resizeObject.contentDocument.defaultView.removeEventListener("resize",this.compareAndNotify),this.$el.removeChild(this._resizeObject),this._resizeObject.onload=null,this._resizeObject=null)}}};const Dt=ut();dt("data-v-b329ee4c");const _t={class:"resize-observer",tabindex:"-1"};ct();const It=Dt((e,i,t,s,r,h)=>(U(),fe("div",_t)));_e.render=It;_e.__scopeId="data-v-b329ee4c";_e.__file="src/components/ResizeObserver.vue";function ke(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ke=function(i){return typeof i}:ke=function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},ke(e)}function Ct(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function xt(e,i){for(var t=0;t<i.length;t++){var s=i[t];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function Tt(e,i,t){return i&&xt(e.prototype,i),e}function Fe(e){return Nt(e)||Et(e)||Ot(e)||At()}function Nt(e){if(Array.isArray(e))return Ae(e)}function Et(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function Ot(e,i){if(e){if(typeof e=="string")return Ae(e,i);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Ae(e,i)}}function Ae(e,i){(i==null||i>e.length)&&(i=e.length);for(var t=0,s=new Array(i);t<i;t++)s[t]=e[t];return s}function At(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vt(e){var i;return typeof e=="function"?i={callback:e}:i=e,i}function Rt(e,i){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s,r,h,c=function(f){for(var S=arguments.length,I=new Array(S>1?S-1:0),x=1;x<S;x++)I[x-1]=arguments[x];if(h=I,!(s&&f===r)){var M=t.leading;typeof M=="function"&&(M=M(f,r)),(!s||f!==r)&&M&&e.apply(void 0,[f].concat(Fe(h))),r=f,clearTimeout(s),s=setTimeout(function(){e.apply(void 0,[f].concat(Fe(h))),s=0},i)}};return c._clear=function(){clearTimeout(s),s=null},c}function Ge(e,i){if(e===i)return!0;if(ke(e)==="object"){for(var t in e)if(!Ge(e[t],i[t]))return!1;return!0}return!1}var Lt=function(){function e(i,t,s){Ct(this,e),this.el=i,this.observer=null,this.frozen=!1,this.createObserver(t,s)}return Tt(e,[{key:"createObserver",value:function(t,s){var r=this;if(this.observer&&this.destroyObserver(),!this.frozen){if(this.options=Vt(t),this.callback=function(g,f){r.options.callback(g,f),g&&r.options.once&&(r.frozen=!0,r.destroyObserver())},this.callback&&this.options.throttle){var h=this.options.throttleOptions||{},c=h.leading;this.callback=Rt(this.callback,this.options.throttle,{leading:function(f){return c==="both"||c==="visible"&&f||c==="hidden"&&!f}})}this.oldResult=void 0,this.observer=new IntersectionObserver(function(g){var f=g[0];if(g.length>1){var S=g.find(function(x){return x.isIntersecting});S&&(f=S)}if(r.callback){var I=f.isIntersecting&&f.intersectionRatio>=r.threshold;if(I===r.oldResult)return;r.oldResult=I,r.callback(I,f)}},this.options.intersection),he(function(){r.observer&&r.observer.observe(r.el)})}}},{key:"destroyObserver",value:function(){this.observer&&(this.observer.disconnect(),this.observer=null),this.callback&&this.callback._clear&&(this.callback._clear(),this.callback=null)}},{key:"threshold",get:function(){return this.options.intersection&&typeof this.options.intersection.threshold=="number"?this.options.intersection.threshold:0}}]),e}();function Xe(e,i,t){var s=i.value;if(s)if(typeof IntersectionObserver>"u")console.warn("[vue-observe-visibility] IntersectionObserver API is not available in your browser. Please install this polyfill: https://github.com/w3c/IntersectionObserver/tree/master/polyfill");else{var r=new Lt(e,s,t);e._vue_visibilityState=r}}function Mt(e,i,t){var s=i.value,r=i.oldValue;if(!Ge(s,r)){var h=e._vue_visibilityState;if(!s){Je(e);return}h?h.createObserver(s,t):Xe(e,{value:s},t)}}function Je(e){var i=e._vue_visibilityState;i&&(i.destroyObserver(),delete e._vue_visibilityState)}var Kt={beforeMount:Xe,updated:Mt,unmounted:Je};function Pt(e){return{all:e=e||new Map,on:function(i,t){var s=e.get(i);s&&s.push(t)||e.set(i,[t])},off:function(i,t){var s=e.get(i);s&&s.splice(s.indexOf(t)>>>0,1)},emit:function(i,t){(e.get(i)||[]).slice().map(function(s){s(t)}),(e.get("*")||[]).slice().map(function(s){s(i,t)})}}}var Bt={itemsLimit:1e3},Ft=/(auto|scroll)/;function Qe(e,i){return e.parentNode===null?i:Qe(e.parentNode,i.concat([e]))}var Ne=function(i,t){return getComputedStyle(i,null).getPropertyValue(t)},Ut=function(i){return Ne(i,"overflow")+Ne(i,"overflow-y")+Ne(i,"overflow-x")},Ht=function(i){return Ft.test(Ut(i))};function Ue(e){if(e instanceof HTMLElement||e instanceof SVGElement){for(var i=Qe(e.parentNode,[]),t=0;t<i.length;t+=1)if(Ht(i[t]))return i[t];return document.scrollingElement||document.documentElement}}function Ve(e){"@babel/helpers - typeof";return Ve=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},Ve(e)}var Ze={items:{type:Array,required:!0},keyField:{type:String,default:"id"},direction:{type:String,default:"vertical",validator:function(i){return["vertical","horizontal"].includes(i)}},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"}};function et(){return this.items.length&&Ve(this.items[0])!=="object"}var Re=!1;if(typeof window<"u"){Re=!1;try{var Wt=Object.defineProperty({},"passive",{get:function(){Re=!0}});window.addEventListener("test",null,Wt)}catch{}}let jt=0;var Me={name:"RecycleScroller",components:{ResizeObserver:_e},directives:{ObserveVisibility:Kt},props:{...Ze,itemSize:{type:Number,default:null},gridItems:{type:Number,default:void 0},itemSecondarySize:{type:Number,default:void 0},minItemSize:{type:[Number,String],default:null},sizeField:{type:String,default:"size"},typeField:{type:String,default:"type"},buffer:{type:Number,default:200},pageMode:{type:Boolean,default:!1},prerender:{type:Number,default:0},emitUpdate:{type:Boolean,default:!1},updateInterval:{type:Number,default:0},skipHover:{type:Boolean,default:!1},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"},listClass:{type:[String,Object,Array],default:""},itemClass:{type:[String,Object,Array],default:""}},emits:["resize","visible","hidden","update","scroll-start","scroll-end"],data(){return{pool:[],totalSize:0,ready:!1,hoverKey:null}},computed:{sizes(){if(this.itemSize===null){const e={"-1":{accumulator:0}},i=this.items,t=this.sizeField,s=this.minItemSize;let r=1e4,h=0,c;for(let g=0,f=i.length;g<f;g++)c=i[g][t]||s,c<r&&(r=c),h+=c,e[g]={accumulator:h,size:c};return this.$_computedMinItemSize=r,e}return[]},simpleArray:et,itemIndexByKey(){const{keyField:e,items:i}=this,t={};for(let s=0,r=i.length;s<r;s++)t[i[s][e]]=s;return t}},watch:{items(){this.updateVisibleItems(!0)},pageMode(){this.applyPageMode(),this.updateVisibleItems(!1)},sizes:{handler(){this.updateVisibleItems(!1)},deep:!0},gridItems(){this.updateVisibleItems(!0)},itemSecondarySize(){this.updateVisibleItems(!0)}},created(){this.$_startIndex=0,this.$_endIndex=0,this.$_views=new Map,this.$_unusedViews=new Map,this.$_scrollDirty=!1,this.$_lastUpdateScrollPosition=0,this.prerender&&(this.$_prerender=!0,this.updateVisibleItems(!1)),this.gridItems&&!this.itemSize&&console.error("[vue-recycle-scroller] You must provide an itemSize when using gridItems")},mounted(){this.applyPageMode(),this.$nextTick(()=>{this.$_prerender=!1,this.updateVisibleItems(!0),this.ready=!0})},activated(){const e=this.$_lastUpdateScrollPosition;typeof e=="number"&&this.$nextTick(()=>{this.scrollToPosition(e)})},beforeUnmount(){this.removeListeners()},methods:{addView(e,i,t,s,r){const h=ht({id:jt++,index:i,used:!0,key:s,type:r}),c=ft({item:t,position:0,nr:h});return e.push(c),c},unuseView(e,i=!1){const t=this.$_unusedViews,s=e.nr.type;let r=t.get(s);r||(r=[],t.set(s,r)),r.push(e),i||(e.nr.used=!1,e.position=-9999)},handleResize(){this.$emit("resize"),this.ready&&this.updateVisibleItems(!1)},handleScroll(e){if(!this.$_scrollDirty){if(this.$_scrollDirty=!0,this.$_updateTimeout)return;const i=()=>requestAnimationFrame(()=>{this.$_scrollDirty=!1;const{continuous:t}=this.updateVisibleItems(!1,!0);t||(clearTimeout(this.$_refreshTimout),this.$_refreshTimout=setTimeout(this.handleScroll,this.updateInterval+100))});i(),this.updateInterval&&(this.$_updateTimeout=setTimeout(()=>{this.$_updateTimeout=0,this.$_scrollDirty&&i()},this.updateInterval))}},handleVisibilityChange(e,i){this.ready&&(e||i.boundingClientRect.width!==0||i.boundingClientRect.height!==0?(this.$emit("visible"),requestAnimationFrame(()=>{this.updateVisibleItems(!1)})):this.$emit("hidden"))},updateVisibleItems(e,i=!1){const t=this.itemSize,s=this.gridItems||1,r=this.itemSecondarySize||t,h=this.$_computedMinItemSize,c=this.typeField,g=this.simpleArray?null:this.keyField,f=this.items,S=f.length,I=this.sizes,x=this.$_views,M=this.$_unusedViews,u=this.pool,m=this.itemIndexByKey;let o,y,w,D,k;if(!S)o=y=D=k=w=0;else if(this.$_prerender)o=D=0,y=k=Math.min(this.prerender,f.length),w=null;else{const b=this.getScroll();if(i){let P=b.start-this.$_lastUpdateScrollPosition;if(P<0&&(P=-P),t===null&&P<h||P<t)return{continuous:!0}}this.$_lastUpdateScrollPosition=b.start;const K=this.buffer;b.start-=K,b.end+=K;let O=0;if(this.$refs.before&&(O=this.$refs.before.scrollHeight,b.start-=O),this.$refs.after){const P=this.$refs.after.scrollHeight;b.end+=P}if(t===null){let P,j=0,le=S-1,F=~~(S/2),se;do se=F,P=I[F].accumulator,P<b.start?j=F:F<S-1&&I[F+1].accumulator>b.start&&(le=F),F=~~((j+le)/2);while(F!==se);for(F<0&&(F=0),o=F,w=I[S-1].accumulator,y=F;y<S&&I[y].accumulator<b.end;y++);for(y===-1?y=f.length-1:(y++,y>S&&(y=S)),D=o;D<S&&O+I[D].accumulator<b.start;D++);for(k=D;k<S&&O+I[k].accumulator<b.end;k++);}else{o=~~(b.start/t*s);const P=o%s;o-=P,y=Math.ceil(b.end/t*s),D=Math.max(0,Math.floor((b.start-O)/t*s)),k=Math.floor((b.end-O)/t*s),o<0&&(o=0),y>S&&(y=S),D<0&&(D=0),k>S&&(k=S),w=Math.ceil(S/s)*t}}y-o>Bt.itemsLimit&&this.itemsLimitError(),this.totalSize=w;let l;const v=o<=this.$_endIndex&&y>=this.$_startIndex;if(v)for(let b=0,K=u.length;b<K;b++)l=u[b],l.nr.used&&(e&&(l.nr.index=m[l.item[g]]),(l.nr.index==null||l.nr.index<o||l.nr.index>=y)&&this.unuseView(l));const T=v?null:new Map;let p,C,N;for(let b=o;b<y;b++){p=f[b];const K=g?p[g]:p;if(K==null)throw new Error(`Key is ${K} on item (keyField is '${g}')`);if(l=x.get(K),!t&&!I[b].size){l&&this.unuseView(l);continue}C=p[c];let O=M.get(C),P=!1;if(!l)v?O&&O.length?l=O.pop():l=this.addView(u,b,p,K,C):(N=T.get(C)||0,(!O||N>=O.length)&&(l=this.addView(u,b,p,K,C),this.unuseView(l,!0),O=M.get(C)),l=O[N],T.set(C,N+1)),x.delete(l.nr.key),l.nr.used=!0,l.nr.index=b,l.nr.key=K,l.nr.type=C,x.set(K,l),P=!0;else if(!l.nr.used&&(l.nr.used=!0,P=!0,O)){const j=O.indexOf(l);j!==-1&&O.splice(j,1)}l.item=p,P&&(b===f.length-1&&this.$emit("scroll-end"),b===0&&this.$emit("scroll-start")),t===null?(l.position=I[b-1].accumulator,l.offset=0):(l.position=Math.floor(b/s)*t,l.offset=b%s*r)}return this.$_startIndex=o,this.$_endIndex=y,this.emitUpdate&&this.$emit("update",o,y,D,k),clearTimeout(this.$_sortTimer),this.$_sortTimer=setTimeout(this.sortViews,this.updateInterval+300),{continuous:v}},getListenerTarget(){let e=Ue(this.$el);return window.document&&(e===window.document.documentElement||e===window.document.body)&&(e=window),e},getScroll(){const{$el:e,direction:i}=this,t=i==="vertical";let s;if(this.pageMode){const r=e.getBoundingClientRect(),h=t?r.height:r.width;let c=-(t?r.top:r.left),g=t?window.innerHeight:window.innerWidth;c<0&&(g+=c,c=0),c+g>h&&(g=h-c),s={start:c,end:c+g}}else t?s={start:e.scrollTop,end:e.scrollTop+e.clientHeight}:s={start:e.scrollLeft,end:e.scrollLeft+e.clientWidth};return s},applyPageMode(){this.pageMode?this.addListeners():this.removeListeners()},addListeners(){this.listenerTarget=this.getListenerTarget(),this.listenerTarget.addEventListener("scroll",this.handleScroll,Re?{passive:!0}:!1),this.listenerTarget.addEventListener("resize",this.handleResize)},removeListeners(){this.listenerTarget&&(this.listenerTarget.removeEventListener("scroll",this.handleScroll),this.listenerTarget.removeEventListener("resize",this.handleResize),this.listenerTarget=null)},scrollToItem(e){let i;const t=this.gridItems||1;this.itemSize===null?i=e>0?this.sizes[e-1].accumulator:0:i=Math.floor(e/t)*this.itemSize,this.scrollToPosition(i)},scrollToPosition(e){const i=this.direction==="vertical"?{scroll:"scrollTop",start:"top"}:{scroll:"scrollLeft",start:"left"};let t,s,r;if(this.pageMode){const h=Ue(this.$el),c=h.tagName==="HTML"?0:h[i.scroll],g=h.getBoundingClientRect(),S=this.$el.getBoundingClientRect()[i.start]-g[i.start];t=h,s=i.scroll,r=e+c+S}else t=this.$el,s=i.scroll,r=e;t[s]=r},itemsLimitError(){throw setTimeout(()=>{console.log("It seems the scroller element isn't scrolling, so it tries to render all the items at once.","Scroller:",this.$el),console.log("Make sure the scroller has a fixed height (or width) and 'overflow-y' (or 'overflow-x') set to 'auto' so it can scroll correctly and only render the items visible in the scroll viewport.")}),new Error("Rendered items limit reached")},sortViews(){this.pool.sort((e,i)=>e.nr.index-i.nr.index)}}};const qt={key:0,ref:"before",class:"vue-recycle-scroller__slot"},Yt={key:1,ref:"after",class:"vue-recycle-scroller__slot"};function Gt(e,i,t,s,r,h){const c=He("ResizeObserver"),g=vt("observe-visibility");return pt((U(),J("div",{class:we(["vue-recycle-scroller",{ready:r.ready,"page-mode":t.pageMode,[`direction-${e.direction}`]:!0}]),onScrollPassive:i[0]||(i[0]=(...f)=>h.handleScroll&&h.handleScroll(...f))},[e.$slots.before?(U(),J("div",qt,[W(e.$slots,"before")],512)):me("v-if",!0),(U(),fe(Be(t.listTag),{ref:"wrapper",style:Le({[e.direction==="vertical"?"minHeight":"minWidth"]:r.totalSize+"px"}),class:we(["vue-recycle-scroller__item-wrapper",t.listClass])},{default:Z(()=>[(U(!0),J(je,null,gt(r.pool,f=>(U(),fe(Be(t.itemTag),qe({key:f.nr.id,style:r.ready?{transform:`translate${e.direction==="vertical"?"Y":"X"}(${f.position}px) translate${e.direction==="vertical"?"X":"Y"}(${f.offset}px)`,width:t.gridItems?`${e.direction==="vertical"&&t.itemSecondarySize||t.itemSize}px`:void 0,height:t.gridItems?`${e.direction==="horizontal"&&t.itemSecondarySize||t.itemSize}px`:void 0}:null,class:["vue-recycle-scroller__item-view",[t.itemClass,{hover:!t.skipHover&&r.hoverKey===f.nr.key}]]},mt(t.skipHover?{}:{mouseenter:()=>{r.hoverKey=f.nr.key},mouseleave:()=>{r.hoverKey=null}})),{default:Z(()=>[W(e.$slots,"default",{item:f.item,index:f.nr.index,active:f.nr.used})]),_:2},1040,["style","class"]))),128)),W(e.$slots,"empty")]),_:3},8,["style","class"])),e.$slots.after?(U(),J("div",Yt,[W(e.$slots,"after")],512)):me("v-if",!0),We(c,{onNotify:h.handleResize},null,8,["onNotify"])],34)),[[g,h.handleVisibilityChange]])}Me.render=Gt;Me.__file="src/components/RecycleScroller.vue";var Ke={name:"DynamicScroller",components:{RecycleScroller:Me},provide(){return typeof ResizeObserver<"u"&&(this.$_resizeObserver=new ResizeObserver(e=>{requestAnimationFrame(()=>{if(Array.isArray(e)){for(const i of e)if(i.target&&i.target.$_vs_onResize){let t,s;if(i.borderBoxSize){const r=i.borderBoxSize[0];t=r.inlineSize,s=r.blockSize}else t=i.contentRect.width,s=i.contentRect.height;i.target.$_vs_onResize(i.target.$_vs_id,t,s)}}})})),{vscrollData:this.vscrollData,vscrollParent:this,vscrollResizeObserver:this.$_resizeObserver}},inheritAttrs:!1,props:{...Ze,minItemSize:{type:[Number,String],required:!0}},emits:["resize","visible"],data(){return{vscrollData:{active:!0,sizes:{},keyField:this.keyField,simpleArray:!1}}},computed:{simpleArray:et,itemsWithSize(){const e=[],{items:i,keyField:t,simpleArray:s}=this,r=this.vscrollData.sizes,h=i.length;for(let c=0;c<h;c++){const g=i[c],f=s?c:g[t];let S=r[f];typeof S>"u"&&!this.$_undefinedMap[f]&&(S=0),e.push({item:g,id:f,size:S})}return e}},watch:{items(){this.forceUpdate()},simpleArray:{handler(e){this.vscrollData.simpleArray=e},immediate:!0},direction(e){this.forceUpdate(!0)},itemsWithSize(e,i){const t=this.$el.scrollTop;let s=0,r=0;const h=Math.min(e.length,i.length);for(let g=0;g<h&&!(s>=t);g++)s+=i[g].size||this.minItemSize,r+=e[g].size||this.minItemSize;const c=r-s;c!==0&&(this.$el.scrollTop+=c)}},beforeCreate(){this.$_updates=[],this.$_undefinedSizes=0,this.$_undefinedMap={},this.$_events=Pt()},activated(){this.vscrollData.active=!0},deactivated(){this.vscrollData.active=!1},unmounted(){this.$_events.all.clear()},methods:{onScrollerResize(){this.$refs.scroller&&this.forceUpdate(),this.$emit("resize")},onScrollerVisible(){this.$_events.emit("vscroll:update",{force:!1}),this.$emit("visible")},forceUpdate(e=!1){(e||this.simpleArray)&&(this.vscrollData.sizes={}),this.$_events.emit("vscroll:update",{force:!0})},scrollToItem(e){const i=this.$refs.scroller;i&&i.scrollToItem(e)},getItemSize(e,i=void 0){const t=this.simpleArray?i??this.items.indexOf(e):e[this.keyField];return this.vscrollData.sizes[t]||0},scrollToBottom(){if(this.$_scrollingToBottom)return;this.$_scrollingToBottom=!0;const e=this.$el;this.$nextTick(()=>{e.scrollTop=e.scrollHeight+5e3;const i=()=>{e.scrollTop=e.scrollHeight+5e3,requestAnimationFrame(()=>{e.scrollTop=e.scrollHeight+5e3,this.$_undefinedSizes===0?this.$_scrollingToBottom=!1:requestAnimationFrame(i)})};requestAnimationFrame(i)})}}};function Xt(e,i,t,s,r,h){const c=He("RecycleScroller");return U(),fe(c,qe({ref:"scroller",items:h.itemsWithSize,"min-item-size":t.minItemSize,direction:e.direction,"key-field":"id","list-tag":e.listTag,"item-tag":e.itemTag},e.$attrs,{onResize:h.onScrollerResize,onVisible:h.onScrollerVisible}),{default:Z(({item:g,index:f,active:S})=>[W(e.$slots,"default",yt(bt({item:g.item,index:f,active:S,itemWithSize:g})))]),before:Z(()=>[W(e.$slots,"before")]),after:Z(()=>[W(e.$slots,"after")]),empty:Z(()=>[W(e.$slots,"empty")]),_:3},16,["items","min-item-size","direction","list-tag","item-tag","onResize","onVisible"])}Ke.render=Xt;Ke.__file="src/components/DynamicScroller.vue";var tt={name:"DynamicScrollerItem",inject:["vscrollData","vscrollParent","vscrollResizeObserver"],props:{item:{required:!0},watchData:{type:Boolean,default:!1},active:{type:Boolean,required:!0},index:{type:Number,default:void 0},sizeDependencies:{type:[Array,Object],default:null},emitResize:{type:Boolean,default:!1},tag:{type:String,default:"div"}},emits:["resize"],computed:{id(){if(this.vscrollData.simpleArray)return this.index;if(this.vscrollData.keyField in this.item)return this.item[this.vscrollData.keyField];throw new Error(`keyField '${this.vscrollData.keyField}' not found in your item. You should set a valid keyField prop on your Scroller`)},size(){return this.vscrollData.sizes[this.id]||0},finalActive(){return this.active&&this.vscrollData.active}},watch:{watchData:"updateWatchData",id(e,i){if(this.$el.$_vs_id=this.id,this.size||this.onDataUpdate(),this.$_sizeObserved){const t=this.vscrollData.sizes[i],s=this.vscrollData.sizes[e];t!=null&&t!==s&&this.applySize(t)}},finalActive(e){this.size||(e?this.vscrollParent.$_undefinedMap[this.id]||(this.vscrollParent.$_undefinedSizes++,this.vscrollParent.$_undefinedMap[this.id]=!0):this.vscrollParent.$_undefinedMap[this.id]&&(this.vscrollParent.$_undefinedSizes--,this.vscrollParent.$_undefinedMap[this.id]=!1)),this.vscrollResizeObserver?e?this.observeSize():this.unobserveSize():e&&this.$_pendingVScrollUpdate===this.id&&this.updateSize()}},created(){if(!this.$isServer&&(this.$_forceNextVScrollUpdate=null,this.updateWatchData(),!this.vscrollResizeObserver)){for(const e in this.sizeDependencies)this.$watch(()=>this.sizeDependencies[e],this.onDataUpdate);this.vscrollParent.$_events.on("vscroll:update",this.onVscrollUpdate)}},mounted(){this.finalActive&&(this.updateSize(),this.observeSize())},beforeUnmount(){this.vscrollParent.$_events.off("vscroll:update",this.onVscrollUpdate),this.unobserveSize()},methods:{updateSize(){this.finalActive?this.$_pendingSizeUpdate!==this.id&&(this.$_pendingSizeUpdate=this.id,this.$_forceNextVScrollUpdate=null,this.$_pendingVScrollUpdate=null,this.computeSize(this.id)):this.$_forceNextVScrollUpdate=this.id},updateWatchData(){this.watchData&&!this.vscrollResizeObserver?this.$_watchData=this.$watch("item",()=>{this.onDataUpdate()},{deep:!0}):this.$_watchData&&(this.$_watchData(),this.$_watchData=null)},onVscrollUpdate({force:e}){!this.finalActive&&e&&(this.$_pendingVScrollUpdate=this.id),(this.$_forceNextVScrollUpdate===this.id||e||!this.size)&&this.updateSize()},onDataUpdate(){this.updateSize()},computeSize(e){this.$nextTick(()=>{if(this.id===e){const i=this.$el.offsetWidth,t=this.$el.offsetHeight;this.applyWidthHeight(i,t)}this.$_pendingSizeUpdate=null})},applyWidthHeight(e,i){const t=~~(this.vscrollParent.direction==="vertical"?i:e);t&&this.size!==t&&this.applySize(t)},applySize(e){this.vscrollParent.$_undefinedMap[this.id]&&(this.vscrollParent.$_undefinedSizes--,this.vscrollParent.$_undefinedMap[this.id]=void 0),this.vscrollData.sizes[this.id]=e,this.emitResize&&this.$emit("resize",this.id)},observeSize(){this.vscrollResizeObserver&&(this.$_sizeObserved||(this.vscrollResizeObserver.observe(this.$el),this.$el.$_vs_id=this.id,this.$el.$_vs_onResize=this.onResize,this.$_sizeObserved=!0))},unobserveSize(){this.vscrollResizeObserver&&this.$_sizeObserved&&(this.vscrollResizeObserver.unobserve(this.$el),this.$el.$_vs_onResize=void 0,this.$_sizeObserved=!1)},onResize(e,i,t){this.id===e&&this.applyWidthHeight(i,t)}},render(){return St(this.tag,this.$slots.default())}};tt.__file="src/components/DynamicScrollerItem.vue";const ye={id:"id",children:"children",label:"label",disabled:"disabled",isLeaf:"isLeaf"};function G(e,i={}){const t={...ye,...i};return e[t.id]??e.id??""}function $e(e,i={}){const t={...ye,...i};return e[t.label]??e.label??""}function ee(e,i={}){const t={...ye,...i};return e[t.children]??e.children??[]}function Jt(e,i={}){const t={...ye,...i};return e[t.disabled]??e.disabled??!1}function ve(e,i={}){const t={...ye,...i};return ee(e,i).length>0?!1:e[t.isLeaf]!==void 0?e[t.isLeaf]??!1:!0}function it(e,i,t=null,s={}){for(const r of e){if(i(r,t)===!1)continue;const c=ee(r,s);c.length>0&&it(c,i,r,s)}}function st(e,i,t={}){for(const s of e){if(i(s))return s;const r=ee(s,t);if(r.length>0){const h=st(r,i,t);if(h)return h}}return null}function Ee(e,i,t={}){return st(e,s=>G(s,t)===i,t)}function Qt(e,i={}){const t=[];return it(e,s=>{t.push(G(s,i))},null,i),t}const Zt=["draggable","data-node-id"],ei={class:"vue-virtual-tree-node__content"},ti={key:0},ii={key:0,class:"vue-virtual-tree-node__checkbox"},si=["checked","indeterminate","disabled"],ri={class:"vue-virtual-tree-node__label"},ni=Ye({__name:"TreeNode",props:{node:{},props:{},showCheckbox:{type:Boolean},expandOnClickNode:{type:Boolean},draggable:{type:Boolean},currentKey:{},dropType:{},indent:{type:[Number,Function]}},emits:["drag-start","drag-enter","drag-leave","drag-over","drag-end","drop"],setup(e,{emit:i}){const t=e,s=i,r=H(!1),h=ne(()=>$e(t.node.data,t.props)),c=ne(()=>ve(t.node.data,t.props)),g=ne(()=>t.currentKey!==null&&t.currentKey!==void 0&&t.currentKey===t.node.id),f=ne(()=>{const o=t.indent;if(typeof o=="function")try{return o(t.node)??18}catch{return 18}return o??18}),S=o=>{t.node.isDisabled||!t.draggable||(r.value=!0,s("drag-start",t.node,o))},I=o=>{t.draggable&&s("drag-enter",t.node,o)},x=o=>{t.draggable&&s("drag-leave",t.node,o)},M=o=>{t.draggable&&s("drag-over",t.node,o)},u=o=>{r.value=!1,s("drag-end",t.node,o)},m=o=>{t.draggable&&s("drop",t.node,o)};return(o,y)=>(U(),J("div",{class:we(["vue-virtual-tree-node",{"is-expanded":e.node.isExpanded,"is-checked":e.node.isChecked,"is-disabled":e.node.isDisabled,"is-leaf":c.value,"is-loading":e.node.isLoading,"is-dragging":r.value,"is-current":g.value,[`drop-${e.dropType}`]:e.dropType}]),style:Le({paddingLeft:`${e.node.level*f.value}px`}),draggable:e.draggable&&!e.node.isDisabled,"data-node-id":e.node.id,onDragstart:S,onDragenter:I,onDragleave:x,onDragover:M,onDragend:u,onDrop:m},[Y("div",ei,[Y("span",{class:we(["vue-virtual-tree-node__expand-icon",{"is-leaf":c.value,"is-loading":e.node.isLoading}])},[e.node.isLoading?(U(),J("span",ti,[W(o.$slots,"loading",{node:e.node,data:e.node.data},void 0,!0)])):W(o.$slots,"icon",{key:1,node:e.node,data:e.node.data},void 0,!0)],2),e.showCheckbox?(U(),J("span",ii,[Y("input",{type:"checkbox",checked:e.node.isChecked,indeterminate:e.node.isIndeterminate,disabled:e.node.isDisabled},null,8,si)])):me("",!0),Y("span",ri,[W(o.$slots,"default",{node:e.node,data:e.node.data},()=>[zt(kt(h.value),1)],!0)])])],46,Zt))}}),rt=(e,i)=>{const t=e.__vccOpts||e;for(const[s,r]of i)t[s]=r;return t},li=rt(ni,[["__scopeId","data-v-9a1a646f"]]);function ai(e,i,t,s){const r=ne(()=>{const l=new Set;return i.value.forEach(v=>{v.isChecked&&l.add(v.id)}),l}),h=ne(()=>{const l=new Set;return i.value.forEach(v=>{v.isIndeterminate&&l.add(v.id)}),l}),c=H(null),g=H(null),f=()=>{i.value.forEach(l=>{l.isChecked=!1,l.isIndeterminate=!1}),e.defaultCheckedKeys&&e.defaultCheckedKeys.length>0&&e.defaultCheckedKeys.forEach(l=>{s(l)&&u(l,!0)})},S=()=>{if(e.currentNodeKey!==void 0){c.value=e.currentNodeKey;const l=t(e.currentNodeKey);g.value=l}},I=l=>{const v=[],T=t(l);if(!T)return v;const p=C=>{ee(C,e.props).forEach(b=>{const K=G(b,e.props);v.push(K),p(b)})};return p(T),v},x=()=>{h.value.clear();const l=new Set(i.value.map(v=>v.id));for(const v of l){const T=I(v);if(T.length===0)continue;const p=T.filter(C=>r.value.has(C));p.length>0&&p.length<T.length&&h.value.add(v)}},M=(l,v)=>{l.isChecked=v,l.isIndeterminate=!1;const T=(C,N)=>{C.children&&C.children.forEach(b=>{b.isChecked=N,b.isIndeterminate=!1,T(b,N)})};T(l,v);const p=C=>{const N=C.parentId;if(N!==null){const b=s(N);if(b){const K=b.children||[],O=K.filter(j=>j.isChecked).length,P=K.filter(j=>j.isIndeterminate).length;O===K.length?(b.isChecked=!0,b.isIndeterminate=!1):O===0&&P===0?(b.isChecked=!1,b.isIndeterminate=!1):(b.isChecked=!1,b.isIndeterminate=!0),p(b)}}};p(l)},u=(l,v,T)=>{const p=s(l);if(!p)return;T??e.checkStrictly??!1?(p.isChecked=v,p.isIndeterminate=!1):M(p,v)},m=l=>{const v=r.value.has(l);u(l,!v)},o=(l,v=null)=>{c.value=l,g.value=v},y=(l=!1,v=!1)=>{const T=[],p=v?new Set([...r.value,...h.value]):r.value;for(const C of p){const N=t(C);N&&(l?ee(N,e.props).length===0&&T.push(N):T.push(N))}return T},w=(l=!1)=>l?y(!0).map(T=>G(T,e.props)):Array.from(r.value),D=(l,v=!1)=>{r.value.clear(),l.filter(p=>v?ve(p,e.props):!0).map(p=>G(p,e.props)).forEach(p=>{u(p,!0)}),e.checkStrictly||x()},k=(l,v=!1)=>{r.value.clear(),(v?l.filter(p=>{const C=t(p);return C&&ve(C,e.props)}):l).forEach(p=>{u(p,!0)}),e.checkStrictly||x()};return S(),Se(()=>e.currentNodeKey,l=>{l!==void 0&&o(l,t(l))}),{checkedKeys:r,halfCheckedKeys:h,selectedKey:c,currentNode:g,initNodeChecked:f,setNodeChecked:u,toggleNodeChecked:m,setCurrentNode:o,getCheckedNodes:y,getCheckedKeys:w,setCheckedNodes:D,setCheckedKeys:k,updateHalfCheckedKeys:x}}function oi(e,i,t,s){const r=H(new Set),h=()=>{if(e.defaultExpandAll){const u=Qt(e.data,e.props);r.value=new Set(u)}else e.defaultExpandedKeys&&e.defaultExpandedKeys.length>0?r.value=new Set(e.defaultExpandedKeys):r.value=new Set},c=u=>{const m=[];return u.children&&u.children.forEach(o=>{m.push(o),o.isExpanded&&m.push(...c(o))}),m},g=u=>{if(typeof u.visibleIndex!="number")return;const m=c(u);m.length!==0&&(t.value.splice(u.visibleIndex+1,0,...m),s())},f=u=>{if(typeof u.visibleIndex!="number")return;const m=c(u);m.length!==0&&(t.value.splice(u.visibleIndex+1,m.length),s())},S=u=>{e.accordion&&i.value.filter(o=>o.parentId===u.parentId&&o.id!==u.id&&o.isExpanded).forEach(o=>{o.isExpanded=!1,r.value.delete(o.id),f(o)}),u.isExpanded=!0,r.value.add(u.id),g(u)},I=(u,m)=>{u.isExpanded=m,r.value.delete(u.id),u.children&&u.children.forEach(o=>{I(o,m)})},x=u=>{f(u),I(u,!1)};return{expandedKeys:r,initExpandedKeys:h,expandNode:S,collapseNode:x,toggleNode:u=>{u.isExpanded?x(u):S(u)}}}function De(e){if(e.length<=1)return e;const i=Math.floor(e.length/2),t=De(e.slice(0,i)),s=De(e.slice(i));return di(t,s)}function di(e,i){const t=[];let s=0,r=0;for(;s<e.length&&r<i.length;)e[s].index<=i[r].index?(t.push(e[s]),s++):(t.push(i[r]),r++);for(;s<e.length;)t.push(e[s]),s++;for(;r<i.length;)t.push(i[r]),r++;return t}function ci(e,i,t,s,r,h,c,g){const f=()=>{const m=i.value.filter(w=>w.parentId===null),o=[],y=w=>{o.push(w),w.isExpanded&&w.children&&w.children.forEach(D=>y(D))};m.forEach(w=>y(w)),g(o)},S=(m,o)=>m?$e(o,e.props).toLowerCase().includes(m.toLowerCase()):!0,I=m=>({...m,children:void 0}),x=H(""),M=m=>(x.value=m,s.value=[],r.value=new Map,m?(h.value=!0,c.value.clear(),new Promise(async o=>{const y=e.filterNodeMethod||S,w=new Map;i.value.forEach(k=>{if(y(m,k.data)){w.has(k.id)||w.set(k.id,I(k));let l=k.parentId;for(;l;){const v=t.value.get(l);v&&!w.has(l)&&w.set(l,I(v)),l=(v==null?void 0:v.parentId)||null}}}),w.forEach(k=>{r.value.set(k.id,k);const l=[];w.forEach(v=>{v.parentId===k.id&&l.push(v)}),l.length>0?(k.children=De(l),k.isExpanded=!0,c.value.add(k.id)):(k.children=void 0,k.isLeaf=!0)});const D=De(Array.from(w.values()));g(D),s.value=D,o(void 0)})):(h.value=!1,i.value.forEach(o=>{o.isLeaf||(o.isExpanded=!0,c.value.add(o.id))}),f(),Promise.resolve()));return{filterText:x,filter:M,clearFilter:()=>{M("")}}}function ui(e,i){const t=H(null),s=H(null),r=H(null),h=u=>!0,c=(u,m,o,y)=>{if(o==="inner"){const w=G(u,y.props),D=k=>G(k,y.props)===w?!0:ee(k,y.props).some(v=>D(v));return!D(m)}return!0};return{draggingNode:t,dropNode:s,dropType:r,handleDragStart:(u,m)=>{t.value=u,m.dataTransfer&&(m.dataTransfer.effectAllowed="move")},handleDragEnter:(u,m)=>{if(!t.value)return;const o=i(t.value.id),y=i(u.id);if(!o||!y||!(e.allowDrag||h)(o))return;s.value=u;const D=m.currentTarget.getBoundingClientRect(),k=m.clientY-D.top,l=D.height,v=l/3;if(k<v?r.value="prev":k>l-v?r.value="next":r.value="inner",!(e.allowDrop||((p,C,N)=>c(p,C,N,e)))(o,y,r.value)){r.value=null;return}m.preventDefault()},handleDragLeave:(u,m)=>{var y;const o=m.relatedTarget;o&&m.currentTarget.contains(o)||((y=s.value)==null?void 0:y.id)===u.id&&(s.value=null,r.value=null)},handleDragOver:(u,m)=>{if(!t.value||!s.value||s.value.id!==u.id)return;const o=i(t.value.id),y=i(u.id);if(!o||!y)return;const w=m.currentTarget.getBoundingClientRect(),D=m.clientY-w.top,k=w.height,l=k/3;let v;if(D<l?v="prev":D>k-l?v="next":v="inner",!(e.allowDrop||((p,C,N)=>c(p,C,N,e)))(o,y,v)){r.value=null,m.preventDefault();return}r.value=v,m.preventDefault()},handleDragEnd:(u,m)=>{t.value=null,s.value=null,r.value=null},handleDrop:(u,m)=>{if(!t.value||!s.value||r.value===null)return;const o=i(t.value.id),y=i(u.id);if(!o||!y||!(e.allowDrop||((k,l,v)=>c(k,l,v,e)))(o,y,r.value))return;t.value=null,s.value=null;const D=r.value;return r.value=null,{draggingNode:o,dropNode:y,dropType:D}}}}function hi(e,i){const t=H([]),s=H(e.data),r=H(new Map),h=H([]),c=H([]),g=H(new Map),f=H(!1),S=ne(()=>f.value?c.value:t.value),I=ne(()=>f.value?g.value:r.value),x=()=>{h.value.forEach((V,B)=>{V.visibleIndex=B})},M=V=>{h.value=V,x()},u=V=>{const B=I.value.get(V);return B?B.data:null},m=V=>I.value.get(V)||null,{checkedKeys:o,halfCheckedKeys:y,selectedKey:w,currentNode:D,toggleNodeChecked:k,setCurrentNode:l,getCheckedNodes:v,getCheckedKeys:T,setCheckedNodes:p,setCheckedKeys:C,initNodeChecked:N}=ai(e,t,u,m),{expandNode:b,collapseNode:K,expandedKeys:O,initExpandedKeys:P}=oi(e,S,h,x),{filter:j}=ci(e,t,r,c,g,f,O,M),le=ui(e,u),F=(V,B=0,oe=null,pe=0,n=!0,a)=>{const d=new Map,z=[];function $(R,q=0,L=null,E=0,Q=!0,re=[],de){const ie=[];let nt=R.length;for(let xe=0;xe<nt;xe++){E++;const ge=R[xe],Te=G(ge,de),be=ee(ge,de),Pe=O.value.has(Te),lt=ve(ge,de),ce={id:Te,data:ge,level:q,parentId:(L==null?void 0:L.id)||null,index:E,isExpanded:Pe,isDisabled:Jt(ge,de),isLeaf:lt,isLoading:!1,isLoaded:!1,isChecked:!1,rawChildren:be.length>0?be:void 0};if(ie.push(ce),re.push(ce),Q&&z.push(ce),be.length>0){const{nodes:at,index:ot}=$(be,q+1,ce,E,Pe&&Q,re,de);ce.children=at,E=ot}d.set(Te,ce)}return{nodes:ie,index:E}}const A=[],{nodes:_}=$(V,B,oe,pe,n,A,a);return{nodes:_,flatNodes:A,nodeMap:d,visibleNodes:z}};let se=!1;const Ie=()=>{if(se)return;se=!0;const{flatNodes:V,nodeMap:B,visibleNodes:oe}=F(s.value,0,null,0,!0,e.props);t.value=V,r.value=B,M(oe),se=!1},Ce=(V,B)=>{const{nodes:oe,flatNodes:pe,nodeMap:n}=F(B,V.level+1,V,V.index+1,!0,e.props);V.children=oe,n.forEach((a,d)=>{r.value.set(d,a)}),t.value.splice(V.index+1,0,...pe),requestAnimationFrame(()=>{for(let a=V.index+pe.length;a<t.value.length;a++){const d=t.value[a];d.index=a}})},X={needEmit:!0,resetExpanded:!0,resetChecked:!0};Se(()=>e.data,V=>{s.value=V,X.needEmit=!0,X.resetChecked=!0,ae()},{deep:!0}),Se(()=>[e.defaultExpandedKeys,e.defaultExpandAll],()=>{X.resetExpanded=!0,ae()},{deep:!0,immediate:!1}),Se(()=>e.defaultCheckedKeys,()=>{X.resetChecked=!0,ae()},{deep:!0,immediate:!1});let te=null;const ae=()=>{te&&clearTimeout(te),te=setTimeout(()=>{X.resetExpanded&&P(),Ie(),X.resetChecked&&N(),X.needEmit&&he(()=>{i("node-generated")}),X.needEmit=!1,X.resetExpanded=!1,X.resetChecked=!1,te=null},5)};return ae(),wt(()=>{te&&(clearTimeout(te),te=null)}),{flatTree:t,visibleNodes:h,expandedKeys:O,checkedKeys:o,rawData:s,getNodeData:u,getFlatNode:m,regenerateFlatTree:ae,flattenTree:F,insertFlatTree:Ce,halfCheckedKeys:y,selectedKey:w,currentNode:D,toggleNodeChecked:k,setCurrentNode:l,getCheckedNodes:v,getCheckedKeys:T,setCheckedNodes:p,setCheckedKeys:C,expandNode:b,collapseNode:K,dragState:le,filter:j}}const fi={key:0,class:"vue-virtual-tree__loading"},vi={class:"default-icon"},pi={key:0,viewBox:"0 0 1024 1024",width:"16",height:"16"},gi={key:1,class:"vue-virtual-tree__empty"},mi=Ye({name:"VirtualTree",__name:"VirtualTree",props:{data:{default:()=>[]},props:{default:()=>({})},showCheckbox:{type:Boolean,default:!1},checkStrictly:{type:Boolean,default:!1},defaultExpandAll:{type:Boolean,default:!1},defaultExpandedKeys:{default:()=>[]},defaultCheckedKeys:{default:()=>[]},currentNodeKey:{},expandOnClickNode:{type:Boolean,default:!0},lazy:{type:Boolean,default:!1},load:{},filterNodeMethod:{},accordion:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},allowDrop:{},allowDrag:{},itemSize:{default:32},height:{default:"100%"},indent:{type:[Number,Function],default:18},loading:{type:Boolean,default:!1}},emits:["node-click","node-check","node-expand","node-collapse","current-change","node-drag-start","node-drag-enter","node-drag-leave","node-drag-over","node-drag-end","node-drop","node-generated"],setup(e,{expose:i,emit:t}){const s=e,r=t,{visibleNodes:h,rawData:c,getNodeData:g,getFlatNode:f,regenerateFlatTree:S,insertFlatTree:I,checkedKeys:x,halfCheckedKeys:M,selectedKey:u,currentNode:m,toggleNodeChecked:o,setCurrentNode:y,getCheckedNodes:w,getCheckedKeys:D,setCheckedNodes:k,setCheckedKeys:l,expandNode:v,collapseNode:T,dragState:p,filter:C}=hi(s,r),N=H(null),b=n=>[n.data,n.isExpanded,n.isChecked,n.isLoading,n.isDisabled,n.level,$e(n.data,s.props)],K=n=>{const a=n.target;if(!a)return null;const d=a.closest("[data-node-id]");if(!d)return null;const z=d.getAttribute("data-node-id");if(!z)return null;const $=isNaN(Number(z))?z:Number(z);return f($)},O=n=>{const a=K(n);if(!a)return;const d=n.target;if(!d)return;const z=d.closest(".vue-virtual-tree-node__expand-icon"),$=d.closest(".vue-virtual-tree-node__checkbox"),A=d.closest(".vue-virtual-tree-node__content");$?F(a):z?a.isExpanded?le(a):j(a):A&&(P(a,n),s.expandOnClickNode&&!ve(a.data,s.props)&&(a.isExpanded?le(a):j(a)))},P=(n,a)=>{n.isDisabled||(y(n.id,n.data),r("current-change",n.data,B(n)),r("node-click",n.data,B(n),a))},j=async n=>{if(!n.isDisabled){if(s.lazy&&!n.isLoaded&&s.load){let a=function(){n.isLoading=!1,n.isLoaded=!0};n.isLoading=!0,n.isLoaded=!1;try{await new Promise(d=>{s.load(n.data,z=>{z&&z.length>0&&I(n,z),a(),d()})})}catch(d){a(),console.error("Lazy load error:",d)}}v(n),r("node-expand",n.data,B(n))}},le=n=>{n.isDisabled||(T(n),r("node-collapse",n.data,B(n)))},F=n=>{if(n.isDisabled)return;o(n.id);const a=w(),d=D(),z=w(!1,!0).filter(A=>{const _=G(A,s.props);return M.value.has(_)&&!x.value.has(_)}),$=Array.from(M.value).filter(A=>!x.value.has(A));r("node-check",n.data,{checkedKeys:d,checkedNodes:a,halfCheckedKeys:$,halfCheckedNodes:z})},se=(n,a)=>{p.handleDragStart(n,a),r("node-drag-start",n.data,a)},Ie=(n,a)=>{var d,z,$;p.handleDragEnter(n,a),((z=(d=p.dropNode)==null?void 0:d.value)==null?void 0:z.id)===n.id&&(($=p.draggingNode)!=null&&$.value)&&r("node-drag-enter",p.draggingNode.value.data,a,n.data)},Ce=(n,a)=>{var d;p.handleDragLeave(n,a),(d=p.draggingNode)!=null&&d.value&&r("node-drag-leave",p.draggingNode.value.data,a,n.data)},X=(n,a)=>{var d,z,$;p.handleDragOver(n,a),((z=(d=p.dropNode)==null?void 0:d.value)==null?void 0:z.id)===n.id&&(($=p.draggingNode)!=null&&$.value)&&r("node-drag-over",p.draggingNode.value.data,a,n.data)},te=(n,a)=>{var d;(d=p.draggingNode)!=null&&d.value&&r("node-drag-end",p.draggingNode.value.data,a),p.handleDragEnd(n,a)},ae=(n,a)=>{const d=p.handleDrop(n,a);d&&r("node-drop",d.draggingNode,d.dropNode,d.dropType,a)},V=new WeakMap,B=n=>{if(V.has(n))return V.get(n);let a=null,d=null;const z=()=>{if(a!==null)return a;if(n.parentId===null)return a=null,null;const L=f(n.parentId);return L?(a=B(L),a):(a=null,null)},$=()=>(d!==null||(d=h.value.filter(E=>E.parentId===n.id).map(E=>B(E))),d),A=()=>h.value.filter(E=>E.parentId===n.parentId&&E.id!==n.id).map(E=>B(E)),_=()=>{const L=[],E=new Set,Q=re=>{h.value.filter(ie=>ie.parentId===re).forEach(ie=>{E.has(ie.id)||(E.add(ie.id),L.push(B(ie)),Q(ie.id))})};return Q(n.id),L},R=()=>{const L=[],E=new Set;let Q=n.parentId;for(;Q!==null&&!E.has(Q);){E.add(Q);const re=f(Q);if(re)L.push(B(re)),Q=re.parentId;else break}return L},q={data:n.data,key:n.id,level:n.level,get parent(){return z()},get children(){return $()},expanded:n.isExpanded,checked:n.isChecked||!1,disabled:n.isDisabled||!1,isLeaf:ve(n.data,s.props),getLabel:()=>$e(n.data,s.props),getData:()=>n.data,getParent:z,getChildren:$,getSiblings:A,getAllChildren:_,getAllParents:R};return V.set(n,q),q},oe=n=>{const a=f(n);return a?B(a):null};return i({getCheckedNodes:(n,a)=>w(n,a),getCheckedKeys:n=>D(n),setCheckedNodes:(n,a)=>{k(n,a)},setCheckedKeys:(n,a)=>{l(n,a)},getCurrentNode:()=>m.value,setCurrentNode:n=>{if(typeof n=="string"||typeof n=="number"){const a=g(n);y(n,a)}else{const a=G(n,s.props);y(a,n)}},getCurrentKey:()=>u.value,setCurrentKey:n=>{y(n,g(n))},filter:n=>C(n).then(()=>{he(()=>{var a,d;(a=N.value)==null||a.scrollToItem(0),(d=N.value)==null||d.forceUpdate()})}),getNode:n=>oe(n),remove:n=>{if(!Ee(c.value,n,s.props))return;const d=(z,$)=>{for(let A=0;A<z.length;A++){if(G(z[A],s.props)===$)return z.splice(A,1),!0;const _=ee(z[A],s.props);if(_.length>0&&d(_,$))return!0}return!1};d(c.value,n),S()},append:(n,a)=>{if(a===void 0)c.value.push(n);else{const d=Ee(c.value,a,s.props);if(d){const $=(s.props||{}).children||"children";d[$]||(d[$]=[]),d[$].push(n)}}S()},insertBefore:(n,a)=>{const d=(z,$,A)=>{for(let _=0;_<z.length;_++){if(G(z[_],s.props)===$)return z.splice(_,0,A),!0;const R=ee(z[_],s.props);if(R.length>0&&d(R,$,A))return!0}return!1};d(c.value,a,n),S()},insertAfter:(n,a)=>{const d=(z,$,A)=>{for(let _=0;_<z.length;_++){if(G(z[_],s.props)===$)return z.splice(_+1,0,A),!0;const R=ee(z[_],s.props);if(R.length>0&&d(R,$,A))return!0}return!1};d(c.value,a,n),S()},updateKeyChildren:(n,a)=>{const d=Ee(c.value,n,s.props);if(d){const $=(s.props||{}).children||"children";d[$]=a,S()}},scrollToNode:(n,a)=>{let d;typeof n=="string"||typeof n=="number"?d=n:d=G(n,s.props);const z=f(d);if(!z){console.warn(`[VirtualTree] Node with key "${d}" not found`);return}const $=async _=>{if(_.parentId!==null){const R=f(_.parentId);R&&!R.isExpanded&&(await j(R),await he(),await $(R))}};(async()=>{await $(z),await he();const _=h.value.findIndex(R=>R.id===d);if(_===-1){console.warn(`[VirtualTree] Node with key "${d}" is not visible`);return}if(N.value){const R=(a==null?void 0:a.align)||"top",q=(a==null?void 0:a.offset)||0,L={top:"start",center:"center",bottom:"end"},E=N.value;E&&typeof E.scrollToItem=="function"&&(q!==0?E.scrollToItem(_,L[R],q):R!=="top"?E.scrollToItem(_,L[R]):E.scrollToItem(_)),typeof E.forceUpdate=="function"&&E.forceUpdate()}})()},nodeGenerated:()=>{r("node-generated")}}),(n,a)=>(U(),J("div",{class:"vue-virtual-tree",style:Le({height:typeof e.height=="number"?`${e.height}px`:e.height}),onClick:O},[e.loading?W(n.$slots,"tree-loading",{key:0},()=>[e.loading?(U(),J("div",fi,[...a[0]||(a[0]=[Y("span",{class:"vue-virtual-tree-loading-text"},"加载中...",-1)])])):me("",!0)],!0):(U(),J(je,{key:1},[e.data.length>0?(U(),fe(ue(Ke),{key:0,ref_key:"dynamicScrollerRef",ref:N,items:ue(h),"min-item-size":e.itemSize||32,class:"vue-virtual-tree__scroller"},{default:Z(({item:d,index:z,active:$})=>[We(ue(tt),{item:d,active:$,"data-index":z,"size-dependencies":b(d),class:"vue-virtual-tree__item"},{default:Z(()=>{var A,_,R;return[(U(),fe(li,{node:d,key:d.id,props:s.props,"show-checkbox":e.showCheckbox,"expand-on-click-node":e.expandOnClickNode,draggable:e.draggable,indent:s.indent,"current-key":ue(u),"drop-type":((_=(A=ue(p).dropNode)==null?void 0:A.value)==null?void 0:_.id)===d.id?((R=ue(p).dropType)==null?void 0:R.value)??null:null,onDragStart:se,onDragEnter:Ie,onDragLeave:Ce,onDragOver:X,onDragEnd:te,onDrop:ae},{default:Z(({node:q,data:L})=>[W(n.$slots,"default",{node:q,data:L},void 0,!0)]),loading:Z(({node:q,data:L})=>[W(n.$slots,"loading",{node:q,data:L},()=>[a[1]||(a[1]=Y("svg",{class:"vue-virtual-tree-node__loading-icon",viewBox:"0 0 24 24",width:"16",height:"16"},[Y("g",{transform:"translate(12,12)"},[Y("circle",{cx:"0",cy:"0",r:"8",fill:"none",stroke:"currentColor","stroke-width":"1",opacity:"0.2"}),Y("g",{class:"vue-virtual-tree-loading-dots"},[Y("circle",{cx:"0",cy:"-8",r:"2",fill:"currentColor"}),Y("circle",{cx:"6.928",cy:"-4",r:"2",fill:"currentColor",opacity:"0.7"}),Y("circle",{cx:"6.928",cy:"4",r:"2",fill:"currentColor",opacity:"0.4"})])])],-1))],!0)]),icon:Z(({node:q,data:L})=>[W(n.$slots,"icon",{node:q,data:L},()=>[Y("span",vi,[q.isLeaf?me("",!0):(U(),J("svg",pi,[...a[2]||(a[2]=[Y("path",{d:"M384 384l256 256-256 256z",fill:"currentColor"},null,-1)])]))])],!0)]),_:3},8,["node","props","show-checkbox","expand-on-click-node","draggable","indent","current-key","drop-type"]))]}),_:2},1032,["item","active","data-index","size-dependencies"])]),_:3},8,["items","min-item-size"])):(U(),J("div",gi,[W(n.$slots,"empty",{},()=>[a[3]||(a[3]=Y("span",null,"暂无数据",-1))],!0)]))],64))],4))}}),bi=rt(mi,[["__scopeId","data-v-b4b1cbb3"]]);export{bi as V,rt as _};
